diff a/xmloff/source/draw/shapeimport.cxx b/xmloff/source/draw/shapeimport.cxx	(rejected hunks)
@@ -419,132 +419,124 @@ void XMLShapeImportHelper::SetAutoStylesContext(SvXMLStylesContext* pNew)
 
 SvXMLShapeContext* XMLShapeImportHelper::CreateGroupChildContext(
     SvXMLImport& rImport,
-    sal_uInt16 p_nPrefix,
-    const OUString& rLocalName,
-    const uno::Reference< xml::sax::XAttributeList>& xAttrList,
+    sal_Int32 nElement,
+    const uno::Reference< xml::sax::XFastAttributeList>& xAttrList,
     uno::Reference< drawing::XShapes > const & rShapes,
     bool bTemporaryShape)
 {
     SdXMLShapeContext *pContext = nullptr;
 
-    const SvXMLTokenMap& rTokenMap = GetGroupShapeElemTokenMap();
-    sal_Int16 nAttrCount = xAttrList.is() ? xAttrList->getLength() : 0;
-
-    switch(rTokenMap.Get(p_nPrefix, rLocalName))
+    switch(nElement)
     {
-        case XML_TOK_GROUP_GROUP:
+        case  XML_ELEMENT(DRAW, XML_G):
         {
             // draw:g inside group context (RECURSIVE)
-            pContext = new SdXMLGroupShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape);
+            pContext = new SdXMLGroupShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape);
             break;
         }
-        case XML_TOK_GROUP_3DSCENE:
+        case XML_ELEMENT(DR3D, XML_SCENE):
         {
             // dr3d:3dscene inside group context
-            pContext = new SdXML3DSceneShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape);
+            pContext = new SdXML3DSceneShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape);
             break;
         }
-        case XML_TOK_GROUP_RECT:
+        case XML_ELEMENT(DRAW, XML_RECT):
         {
             // draw:rect inside group context
-            pContext = new SdXMLRectShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape );
+            pContext = new SdXMLRectShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape );
             break;
         }
-        case XML_TOK_GROUP_LINE:
+        case XML_ELEMENT(DRAW, XML_LINE):
         {
             // draw:line inside group context
-            pContext = new SdXMLLineShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape );
+            pContext = new SdXMLLineShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape );
             break;
         }
-        case XML_TOK_GROUP_CIRCLE:
-        case XML_TOK_GROUP_ELLIPSE:
+        case XML_ELEMENT(DRAW, XML_CIRCLE):
+        case XML_ELEMENT(DRAW, XML_ELLIPS):
         {
             // draw:circle or draw:ellipse inside group context
-            pContext = new SdXMLEllipseShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape );
+            pContext = new SdXMLEllipseShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape );
             break;
         }
-        case XML_TOK_GROUP_POLYGON:
-        case XML_TOK_GROUP_POLYLINE:
+        case XML_ELEMENT(DRAW, XML_POLYGON):
+        case XML_ELEMENT(DRAW, XML_POLYLINE):
         {
             // draw:polygon or draw:polyline inside group context
-            pContext = new SdXMLPolygonShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes,
-                rTokenMap.Get(p_nPrefix, rLocalName) == XML_TOK_GROUP_POLYGON, bTemporaryShape );
+            pContext = new SdXMLPolygonShapeContext( rImport, nElement, xAttrList, rShapes,
+                rTokenMap.Get(p_nPrefix, rLocalName) == XML_ELEMENT(DRAW, XML_POLYGON), bTemporaryShape );
             break;
         }
-        case XML_TOK_GROUP_PATH:
+        case XML_ELEMENT(DRAW, XML_PATH):
         {
             // draw:path inside group context
-            pContext = new SdXMLPathShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape);
+            pContext = new SdXMLPathShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape);
             break;
         }
-        case XML_TOK_GROUP_FRAME:
+        case XML_ELEMENT(DRAW, XML_FRAME):
         {
             // text:text-box inside group context
-            pContext = new SdXMLFrameShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape );
+            pContext = new SdXMLFrameShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape );
             break;
         }
-        case XML_TOK_GROUP_CONTROL:
+        case XML_ELEMENT(DRAW, XML_CONTROL):
         {
             // draw:control inside group context
-            pContext = new SdXMLControlShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape );
+            pContext = new SdXMLControlShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape );
             break;
         }
-        case XML_TOK_GROUP_CONNECTOR:
+        case XML_ELEMENT(DRAW, XML_CONNECTOR):
         {
             // draw:connector inside group context
-            pContext = new SdXMLConnectorShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape );
+            pContext = new SdXMLConnectorShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape );
             break;
         }
-        case XML_TOK_GROUP_MEASURE:
+        case XML_ELEMENT(DRAW, XML_MEASURE):
         {
             // draw:measure inside group context
-            pContext = new SdXMLMeasureShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape );
+            pContext = new SdXMLMeasureShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape );
             break;
         }
-        case XML_TOK_GROUP_PAGE:
+        case XML_ELEMENT(DRAW, XML_PAGE_THUMBNAIL):
         {
             // draw:page inside group context
-            pContext = new SdXMLPageShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape );
+            pContext = new SdXMLPageShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape );
             break;
         }
-        case XML_TOK_GROUP_CAPTION:
-        case XML_TOK_GROUP_ANNOTATION:
+        case XML_ELEMENT(DRAW, XML_CAPTION):
+        case XML_ELEMENT(OFFICE, XML_ANNOTATION):
         {
             // draw:caption inside group context
-            pContext = new SdXMLCaptionShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape );
+            pContext = new SdXMLCaptionShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape );
             break;
         }
-        case XML_TOK_GROUP_CHART:
+        case XML_ELEMENT(CHART, XML_CHART):
         {
             // chart:chart inside group context
-            pContext = new SdXMLChartShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes, bTemporaryShape );
+            pContext = new SdXMLChartShapeContext( rImport, nElement, xAttrList, rShapes, bTemporaryShape );
             break;
         }
-        case XML_TOK_GROUP_CUSTOM_SHAPE:
+        case XML_ELEMENT(DRAW, XML_CUSTOM_SHAPE):
         {
             // draw:customshape
-            pContext = new SdXMLCustomShapeContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes );
+            pContext = new SdXMLCustomShapeContext( rImport, nElement, xAttrList, rShapes );
             break;
         }
-         case XML_TOK_GROUP_A:
-         {
-             return new SdXMLShapeLinkContext( rImport, p_nPrefix, rLocalName, xAttrList, rShapes );
-         }
+        case XML_ELEMENT(DRAW, XML_A):
+        {
+            return new SdXMLShapeLinkContext( rImport, nElement, xAttrList, rShapes );
+        }
         // add other shapes here...
         default:
-            return new SvXMLShapeContext( rImport, p_nPrefix, rLocalName, bTemporaryShape );
+        {
+            XMLOFF_WARN_UNKNOWN_ELEMENT("xmloff", nElement);
+            return new SvXMLShapeContext( rImport, nElement, bTemporaryShape );
+        }
     }
 
     // now parse the attribute list and call the child context for each unknown attribute
-    for(sal_Int16 a(0); a < nAttrCount; a++)
-    {
-        const OUString& rAttrName = xAttrList->getNameByIndex(a);
-        OUString aLocalName;
-        sal_uInt16 nPrefix = rImport.GetNamespaceMap().GetKeyByAttrName(rAttrName, &aLocalName);
-        const OUString aValue( xAttrList->getValueByIndex(a) );
-
-        pContext->processAttribute( nPrefix, aLocalName, aValue );
-    }
+    for( auto& aIter : sax_fastparser::castToFastAttributeList(xAttrList) )
+        pContext->processAttribute( aIter.getToken(), aIter.getValue() );
 
     return pContext;
 }
