{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "172ca897_72e226a3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2021-12-07T09:40:44Z",
      "side": 1,
      "message": "So this splits up some component files into multiple component files for a single shared library (svx/util/crashreport.component broken out of svx/util/svx.component, and sw/util/sw_mm.component broken out of sw/util/sw.component), which then leads in the resulting services rdb file to multiple \u003ccomponent\u003e elements with the same \"uri\" attribute.  While the current implementation in cppuhelper/source/servicemanager.cxx appears to happen to work fine with multiple \u003ccomponent\u003e elements with the same \"uri\" attribute, I\u0027m not really happy with this change:  It opens the door for inconsistencies among the other attributes (\"environment\", \"loader\", \"prefix\") of multiple \u003ccomponent\u003e elements that describe what is conceptionally a single component with a unique \"uri\", and which needs to have unambiguous \"environment\", \"loader\", and \"prefix\" attributes.  I think I would prefer an alternative approach where individual \u003cimplementation\u003e elements in a component file can be marked with some condition, and those conditions are then processed and acted upon when assembling a services rdb file in solenv/gbuild/Rdb.mk and solenv/bin/packcomponents.xslt.",
      "revId": "1c9a40299d328c78c035ca63ccdf22c5c669a03b",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "00a73b4d_e84283d9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1000562
      },
      "writtenOn": "2021-12-07T14:38:17Z",
      "side": 1,
      "message": "\u003e I think I would prefer an alternative approach where individual \u003cimplementation\u003e elements in a component file can be marked with some condition, and those conditions are then processed and acted upon when assembling a services rdb file in solenv/gbuild/Rdb.mk and solenv/bin/packcomponents.xslt.\n\nThat seems too complicated. And then you need additional sync logic between the component file and build system, which I wanted to avoid. I wanted to get rid of the duplicated build logic. AFAIK know there is no additional info in the component tag, that gbuild doesn\u0027t already have:\n\n* Based on the library type, you can select the loader\n* The \"@CPPU_ENV@\" already comes from gbuild\n* The URI comes from the library name.\n\nSo my suggestion: get rid of the component tag in gbuild\u0027s component files and generate the libraries component files to concat by Rdb from implementation snippets selected by gbuild. Any reason why this can\u0027t work?",
      "parentUuid": "172ca897_72e226a3",
      "revId": "1c9a40299d328c78c035ca63ccdf22c5c669a03b",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4003191f_cf769ee1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2021-12-07T15:11:49Z",
      "side": 1,
      "message": "\u003e That seems too complicated. And then you need additional sync logic between the component file and build system, which I wanted to avoid. I wanted to get rid of the duplicated build logic. AFAIK know there is no additional info in the component tag, that gbuild doesn\u0027t already have:\n\u003e \n\u003e * Based on the library type, you can select the loader\n\u003e * The \"@CPPU_ENV@\" already comes from gbuild\n\u003e * The URI comes from the library name.\n\nInformation about the \"prefix\" attribute is missing.  (Plus, we might want to extend the set of component element attributes in the future.)\n\n\u003e So my suggestion: get rid of the component tag in gbuild\u0027s component files and generate the libraries component files to concat by Rdb from implementation snippets selected by gbuild. Any reason why this can\u0027t work?\n\nThen why didn\u0027t you do that?  Why did you need to introduce a new --enable-services-rdb-from-build option?  Why did you need to split the svx and sw component files?  Me confused.",
      "parentUuid": "00a73b4d_e84283d9",
      "revId": "1c9a40299d328c78c035ca63ccdf22c5c669a03b",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "91b54dcc_679fdb91",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1000562
      },
      "writtenOn": "2021-12-07T15:43:19Z",
      "side": 1,
      "message": "\u003e Information about the \"prefix\" attribute is missing.  (Plus, we might want to extend the set of component element attributes in the future.)\n\nThe prefix also comes from the library, when it calls gb_ComponentTarget_ComponentTarget. I did forget to mention that. It\u0027s not that the whole concept of writing the \"\u003ccomponent\u003e\" tag from gbuild is un-extendable.\n\n\u003e \u003e So my suggestion: get rid of the component tag in gbuild\u0027s component files and generate the libraries component files to concat by Rdb from implementation snippets selected by gbuild. Any reason why this can\u0027t work?\n\u003e \n\u003e Then why didn\u0027t you do that?  Why did you need to introduce a new --enable-services-rdb-from-build option?  Why did you need to split the svx and sw component files?  Me confused.\n\nI don\u0027t follow. Because it works? And the RDB has just the components built and the workdir/CustomTarget/static/component_maps.cxx has just the existing constructors. No more extra management of solenv/bin/native-code.py, because the input from gbuild is correct. And it\u0027s just managed in gbuild. In theory you have the same logic for the source files then for the component files / snippets.\n\nAs I wrote in the commit message, I wanted to get rid of the duplicated build logic outside of the build system. This is mainly used by the WASM build, which is a stripped down version of LO to \"just\" Writer.\n\nAnd there is a horrible additional patch waiting in feature/wasm to link static binaries from the exposed gbuild info. That can either build LO WASM or link a static soffice.bin + oosplash.",
      "parentUuid": "4003191f_cf769ee1",
      "revId": "1c9a40299d328c78c035ca63ccdf22c5c669a03b",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b61b6e4e_2083f420",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 1000562
      },
      "writtenOn": "2021-12-07T17:57:16Z",
      "side": 1,
      "message": "Thinking a bit more about a \"strip stuff from component file\": one problem is, that normally the build system knows what it builds, but not what it doesn\u0027t. That probably will make a solution stripping stuff instead of adding stuff harder, as you would need to remove the implementations you don\u0027t build. But then you probably can also match anything that doesn\u0027t match X|Y.",
      "parentUuid": "91b54dcc_679fdb91",
      "revId": "1c9a40299d328c78c035ca63ccdf22c5c669a03b",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    }
  ]
}