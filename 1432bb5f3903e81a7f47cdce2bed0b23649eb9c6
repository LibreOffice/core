{
  "comments": [
    {
      "key": {
        "uuid": "7f7f9b97_0b423111",
        "filename": "sal/osl/w32/module.cxx",
        "patchSetId": 2
      },
      "lineNbr": 243,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2019-11-08T09:09:13Z",
      "side": 1,
      "message": "There is a race with osl_unloadModule calling FreeLibrary between the call to GetModuelFileNameW and the insertion into the cache here.",
      "revId": "1432bb5f3903e81a7f47cdce2bed0b23649eb9c6",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7f7f9b97_eb46d521",
        "filename": "sal/osl/w32/module.cxx",
        "patchSetId": 2
      },
      "lineNbr": 243,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2019-11-08T09:14:48Z",
      "side": 1,
      "message": "In this case, GetModuleFileNameW needs checking the return value, and return false if failed, to also account for races with unloading modules between GetModuleInformation and GetModuleFileNameW",
      "parentUuid": "7f7f9b97_0b423111",
      "revId": "1432bb5f3903e81a7f47cdce2bed0b23649eb9c6",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7f7f9b97_cb22f952",
        "filename": "sal/osl/w32/module.cxx",
        "patchSetId": 2
      },
      "lineNbr": 243,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2019-11-08T09:42:20Z",
      "side": 1,
      "message": "Indeed, the whole EnumProcessModules+EnumProcessModules+GetModuleInformat+GetModuleFileNameW chain appears to be prone to races with other threads.  But that\u0027s a somewhat unrelated topic to adding yet another, different race here by introducing a cache that is not properly synchronized.",
      "parentUuid": "7f7f9b97_eb46d521",
      "revId": "1432bb5f3903e81a7f47cdce2bed0b23649eb9c6",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7f7f9b97_4ba269b0",
        "filename": "sal/osl/w32/module.cxx",
        "patchSetId": 2
      },
      "lineNbr": 243,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2019-11-08T10:23:42Z",
      "side": 1,
      "message": "\u003e There is a race with osl_unloadModule calling FreeLibrary between\n \u003e the call to GetModuelFileNameW\n\n...or whatever call it is in the EnumProcessModules+EnumProcessModules+GetModuleInformat+GetModuleFileNameW chain that would cause the GetModuleFileNameW call to successfully provide the module name in aBuffer if there is no intervening call to FreeLibrary",
      "parentUuid": "7f7f9b97_0b423111",
      "revId": "1432bb5f3903e81a7f47cdce2bed0b23649eb9c6",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    }
  ]
}