-*- Mode: diff -*-

LO needs to build both against MacOSX SDK and not produce universal binaries.

diff -ru python3.orig/configure python3/configure
--- python3.orig/configure	2015-07-26 17:36:11.808497783 +0200
+++ python3/configure	2015-07-26 17:38:49.016508337 +0200
@@ -6794,7 +6794,20 @@
         then
             case "$UNIVERSAL_ARCHS" in
             32-bit)
-               UNIVERSAL_ARCH_FLAGS="-arch ppc -arch i386"
+           # LO does not use Universal Binaries (but the only way to set a SDK
+           # here implies that, so de-universalize here...)
+           case `/usr/bin/arch` in
+           i386)
+               UNIVERSAL_ARCH_FLAGS="-arch i386"
+               ;;
+           ppc)
+               UNIVERSAL_ARCH_FLAGS=""
+               ;;
+           *)
+               as_fn_error $? "Unexpected output of 'arch' on OSX" "$LINENO" 5
+               ;;
+           esac
+
                LIPO_32BIT_FLAGS=""
                ARCH_RUN_32BIT=""
                ;;
Only in python3: .#configure
Only in python3: #configure#
diff -ru python3.orig/Mac/Makefile.in python3/Mac/Makefile.in
--- python3.orig/Mac/Makefile.in	2015-07-05 18:50:07.000000000 +0200
+++ python3/Mac/Makefile.in	2015-07-26 17:40:14.860514100 +0200
@@ -43,7 +43,7 @@
 INSTALL_SCRIPT= @INSTALL_SCRIPT@
 INSTALL_DATA=@INSTALL_DATA@
 LN=@LN@
-STRIPFLAG=-s
+STRIPFLAG=
 CPMAC=CpMac
 
 APPTEMPLATE=$(srcdir)/Resources/app
diff -ru python3.orig/Mac/Resources/app/Info.plist.in python3/Mac/Resources/app/Info.plist.in
--- python3.orig/Mac/Resources/app/Info.plist.in	2015-07-05 18:50:07.000000000 +0200
+++ python3/Mac/Resources/app/Info.plist.in	2015-07-26 17:42:00.974521224 +0200
@@ -18,7 +18,7 @@
 		</dict>
 	</array>
 	<key>CFBundleExecutable</key>
-	<string>Python</string>
+	<string>LibreOfficePython</string>
 	<key>CFBundleGetInfoString</key>
 	<string>%version%, (c) 2001-2015 Python Software Foundation.</string>
 	<key>CFBundleHelpBookFolder</key>
diff -ru python3.orig/Mac/Resources/framework/Info.plist.in python3/Mac/Resources/framework/Info.plist.in
--- python3.orig/Mac/Resources/framework/Info.plist.in	2015-07-05 18:50:07.000000000 +0200
+++ python3/Mac/Resources/framework/Info.plist.in	2015-07-26 17:41:15.996518204 +0200
@@ -5,7 +5,7 @@
 	<key>CFBundleDevelopmentRegion</key>
 	<string>English</string>
 	<key>CFBundleExecutable</key>
-	<string>Python</string>
+	<string>@PYTHONFRAMEWORK@</string>
 	<key>CFBundleGetInfoString</key>
 	<string>Python Runtime and Library</string>
 	<key>CFBundleIdentifier</key>
diff -ru python3.orig/setup.py python3/setup.py
--- python3.orig/setup.py	2015-07-26 17:36:11.804497783 +0200
+++ python3/setup.py	2015-07-26 17:39:48.599512337 +0200
@@ -468,11 +468,11 @@
         # Ensure that /usr/local is always used, but the local build
         # directories (i.e. '.' and 'Include') must be first.  See issue
         # 10520.
-        if not cross_compiling:
+        if not cross_compiling and host_platform != 'darwin':
             add_dir_to_list(self.compiler.library_dirs, '/usr/local/lib')
             add_dir_to_list(self.compiler.include_dirs, '/usr/local/include')
         # only change this for cross builds for 3.3, issues on Mageia
-        if cross_compiling:
+        if cross_compiling or host_platform == 'darwin':
             self.add_gcc_paths()
         self.add_multiarch_paths()
