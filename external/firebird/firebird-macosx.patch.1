--- firebird.org/builds/posix/prefix.darwin_x86_64	2016-08-01 20:02:48.000000000 +0200
+++ firebird/builds/posix/prefix.darwin_x86_64	2016-08-01 21:42:45.000000000 +0200
@@ -27,9 +27,6 @@
 # configure using --with-builtin-tommath
 # or add the relevant -I, -L for an installed version of libtommath
 
-DYLD_LIBRARY_PATH=$(HOME)/icu54/icu/source/lib
-export DYLD_LIBRARY_PATH
-
 #DYLD_PRINT_ENV=1
 #export DYLD_PRINT_ENV
 
@@ -39,15 +36,15 @@
 MACOSX_DEPLOYMENT_TARGET=10.9
 export MACOSX_DEPLOYMENT_TARGET
 
-PROD_FLAGS=-DDARWIN -pipe -O2 -MMD -fPIC -fno-common -mmacosx-version-min=10.9
-DEV_FLAGS=-ggdb -DDARWIN -pipe -MMD -fPIC -fno-omit-frame-pointer -fno-common -Wall -fno-optimize-sibling-calls -mmacosx-version-min=10.9 -Wno-non-virtual-dtor
+PROD_FLAGS=-O1 -DDARWIN -pipe -MMD -fPIC -fno-common
+DEV_FLAGS=-ggdb -DDARWIN -pipe -MMD -fPIC -fno-omit-frame-pointer -fno-common -Wall -fno-optimize-sibling-calls -Wno-non-virtual-dtor
 CXXFLAGS:=$(CXXFLAGS) -fvisibility-inlines-hidden -fvisibility=hidden -msse4
 
 EXE_LINK_OPTIONS:= 
 UNDEF_PLATFORM=
 
 LINK_LIBS+=-liconv
-MATHLIB=$(ROOT)/extern/libtommath/.libs/libtommath.a
+MATHLIB=-ltommath
 SO_LINK_LIBS+=-liconv
 
 include $(ROOT)/gen/darwin.defaults
--- firebird.org/builds/posix/postfix.darwin	2016-08-01 20:02:48.000000000 +0200
+++ firebird/builds/posix/postfix.darwin	2016-08-01 22:17:49.000000000 +0200
@@ -118,9 +118,9 @@
 	cp ../gen/Release/firebird/lib/libfbclient.dylib $(FB_FW)/Versions/A/Firebird
 	cp ../gen/Release/firebird/lib/libfbclient.dylib $(FB_FW)/Versions/A/Libraries/libfbclient.dylib
 	cp $(ICU_LOC)*.dylib ../gen/Release/firebird/lib/
-	cp ../gen/Release/firebird/lib/libicudata.dylib $(FB_FW)/Versions/A/Libraries/libicudata.dylib
-	cp ../gen/Release/firebird/lib/libicui18n.dylib $(FB_FW)/Versions/A/Libraries/libicui18n.dylib
-	cp ../gen/Release/firebird/lib/libicuuc.dylib $(FB_FW)/Versions/A/Libraries/libicuuc.dylib
+	#cp ../gen/Release/firebird/lib/libicudata.dylib $(FB_FW)/Versions/A/Libraries/libicudata.dylib
+	#cp ../gen/Release/firebird/lib/libicui18n.dylib $(FB_FW)/Versions/A/Libraries/libicui18n.dylib
+	#cp ../gen/Release/firebird/lib/libicuuc.dylib $(FB_FW)/Versions/A/Libraries/libicuuc.dylib
 	cp ../gen/Release/firebird/lib/libib_util.dylib $(FB_FW)/Versions/A/Libraries/libib_util.dylib
 	mkdir -p $(FB_FW)/Versions/A/Resources/English.lproj
 	mkdir -p $(FB_FW)/Versions/A/Resources/UDF
--- firebird.org/builds/posix/Makefile.in	2016-08-08 17:58:20.000000000 +0200
+++ firebird/builds/posix/Makefile.in	2016-08-08 17:57:17.000000000 +0200
@@ -191,6 +191,9 @@
 	$(MAKE) plugins
 	$(MAKE) examples
 	$(MAKE) rest
+	install_name_tool -id @__________________________________________________OOO/libfbclient.dylib.3.0.4 $(LIB)/libfbclient.dylib
+	install_name_tool -id @__________________________________________________OOO/libEngine12.dylib $(PLUGINS)/libEngine12.dylib
+	install_name_tool -change $(LIB)/libfbclient.dylib.3.0.4 @loader_path/libfbclient.dylib.3.0.4 $(PLUGINS)/libEngine12.dylib
 
 
 cross_process:
--- firebird.org/src/common/unicode_util.cpp	2016-07-07 13:55:55.992234709 +0200
+++ firebird/src/common/unicode_util.cpp	2016-08-10 11:25:46.422331020 +0200
@@ -63,10 +63,10 @@
 const char* const ucTemplate = "icuuc%s.dll";
 #endif
 #elif defined(DARWIN)
-const char* const inTemplate = "/Library/Frameworks/Firebird.framework/Versions/A/Libraries/libicui18n.dylib";
-const char* const ucTemplate = "/Library/Frameworks/Firebird.framework/versions/A/Libraries/libicuuc.dylib";
-//const char* const inTemplate = "libicui18n.dylib";
-//const char* const ucTemplate = "libicuuc.dylib";
+//const char* const inTemplate = "/Library/Frameworks/Firebird.framework/Versions/A/Libraries/libicui18n.dylib";
+//const char* const ucTemplate = "/Library/Frameworks/Firebird.framework/versions/A/Libraries/libicuuc.dylib";
+const char* const inTemplate = "libicui18n.dylib.%s";
+const char* const ucTemplate = "libicuuc.dylib.%s";
 #elif defined(HPUX)
 const char* const inTemplate = "libicui18n.sl.%s";
 const char* const ucTemplate = "libicuuc.sl.%s";
--- firebird.org/src/common/utils.cpp	2016-08-16 10:11:10.000000000 +0200
+++ firebird/src/common/utils.cpp	2016-08-16 11:27:09.000000000 +0200
@@ -1027,10 +1027,18 @@
 			return s;
 		}
 
-                // Set relative path to Engine12 dynamic library
+                // Set path to Engine12 dynamic library.
                 if(prefType == Firebird::IConfigManager::DIR_PLUGINS)
                 {
-                    s = name;
+                    const char * const envpath = getenv("LIBREOFFICE_FIREBIRD_LIB");
+                    if(envpath != nullptr)
+                    {
+                        PathUtils::concatPath(s, envpath, name);
+                    }
+                    else
+                    {
+                        s = name;
+                    }
                     return s;
                 }
 	}
