--- firebird.org/builds/posix/prefix.darwin_x86_64	2016-08-01 20:02:48.000000000 +0200
+++ firebird/builds/posix/prefix.darwin_x86_64	2016-08-01 21:42:45.000000000 +0200
@@ -27,9 +27,6 @@
 # configure using --with-builtin-tommath
 # or add the relevant -I, -L for an installed version of libtommath
 
-DYLD_LIBRARY_PATH=$(HOME)/icu54/icu/source/lib
-export DYLD_LIBRARY_PATH
-
 #DYLD_PRINT_ENV=1
 #export DYLD_PRINT_ENV
 
@@ -48,6 +45,7 @@
 
 LINK_LIBS+=-liconv
 #MATHLIB=$(ROOT)/extern/libtommath/.libs/libtommath.a
+MATHLIB=-ltommath
 SO_LINK_LIBS+=-liconv
 
 include $(ROOT)/gen/darwin.defaults
--- firebird.org/builds/posix/postfix.darwin	2016-08-01 20:02:48.000000000 +0200
+++ firebird/builds/posix/postfix.darwin	2016-08-01 22:17:49.000000000 +0200
@@ -41,9 +41,9 @@
	mkdir -p $(FB_FW)/Versions/A/Resources/lib
	cp ../gen/$(TARGET)/firebird/lib/libtommath.dylib $(FB_FW)/Versions/A/Resources/lib/
	cp ../gen/$(TARGET)/firebird/lib/libfbclient.dylib $(FB_FW)/Versions/A/Resources/lib/
-	cp ../gen/$(TARGET)/firebird/lib/libicudata.[0-9][0-9].dylib $(FB_FW)/Versions/A/Resources/lib/
-	cp ../gen/$(TARGET)/firebird/lib/libicui18n.[0-9][0-9].dylib $(FB_FW)/Versions/A/Resources/lib/
-	cp ../gen/$(TARGET)/firebird/lib/libicuuc.[0-9][0-9].dylib $(FB_FW)/Versions/A/Resources/lib/
+	#cp ../gen/$(TARGET)/firebird/lib/libicudata.[0-9][0-9].dylib $(FB_FW)/Versions/A/Resources/lib/
+	#cp ../gen/$(TARGET)/firebird/lib/libicui18n.[0-9][0-9].dylib $(FB_FW)/Versions/A/Resources/lib/
+	#cp ../gen/$(TARGET)/firebird/lib/libicuuc.[0-9][0-9].dylib $(FB_FW)/Versions/A/Resources/lib/
	cp ../gen/$(TARGET)/firebird/lib/libib_util.dylib $(FB_FW)/Versions/A/Resources/lib/
	ln -s ../Resources/lib/libfbclient.dylib $(FB_FW)/Versions/A/Libraries/libfbclient.dylib
	ln -s ../Resources/lib/libib_util.dylib $(FB_FW)/Versions/A/Libraries/libib_util.dylib
--- firebird.org/builds/posix/Makefile.in	2016-08-08 17:58:20.000000000 +0200
+++ firebird/builds/posix/Makefile.in	2016-08-08 17:57:17.000000000 +0200
@@ -191,6 +191,9 @@
 	$(MAKE) plugins
 	$(MAKE) examples
 	$(MAKE) rest
+	install_name_tool -id @__________________________________________________OOO/libfbclient.dylib.3.0.7 $(LIB)/libfbclient.dylib
+	install_name_tool -id @__________________________________________________OOO/libEngine12.dylib $(PLUGINS)/libEngine12.dylib
+	install_name_tool -change $(LIB)/libfbclient.dylib.3.0.0 @loader_path/libfbclient.dylib.3.0.7 $(PLUGINS)/libEngine12.dylib
 
 
 cross_process:
--- firebird.org/src/common/unicode_util.cpp	2016-07-07 13:55:55.992234709 +0200
+++ firebird/src/common/unicode_util.cpp	2016-08-10 11:25:46.422331020 +0200
@@ -354,6 +354,16 @@
	{
		s.printf(*p, majorVersion, minorVersion);
		filename.printf(templateName, s.c_str());
+                const char * envpath = getenv("LIBREOFFICE_FIREBIRD_LIB");
+                if(envpath == nullptr)
+                {
+                    envpath = getenv("LIBREOFFICE_ICU_LIB");
+                }
+                if(envpath != nullptr)
+                {
+                    s = filename.c_str();
+                    PathUtils::concatPath(filename, envpath, s.c_str());
+                }
 
		ModuleLoader::Module* module = ModuleLoader::fixAndLoadModule(NULL, filename);
		if (module)
--- firebird.org/src/common/utils.cpp	2016-08-16 10:11:10.000000000 +0200
+++ firebird/src/common/utils.cpp	2016-08-16 11:27:09.000000000 +0200
@@ -1027,10 +1027,18 @@
 			return s;
 		}
 
-                // Set relative path to Engine12 dynamic library
+                // Set path to Engine12 dynamic library.
                 if(prefType == Firebird::IConfigManager::DIR_PLUGINS)
                 {
-                    s = name;
+                    const char * const envpath = getenv("LIBREOFFICE_FIREBIRD_LIB");
+                    if(envpath != nullptr)
+                    {
+                        PathUtils::concatPath(s, envpath, name);
+                    }
+                    else
+                    {
+                        s = name;
+                    }
                     return s;
                 }
 	}
