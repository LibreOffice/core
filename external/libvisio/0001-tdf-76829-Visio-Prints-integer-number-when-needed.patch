--- src/lib/VSDFieldList.cpp
+++ src/lib/VSDFieldList.cpp
@@ -7,9 +7,11 @@
  * file, You can obtain one at http://mozilla.org/MPL/2.0/.
  */

+#include <cmath>
 #include <time.h>
 #include "VSDCollector.h"
 #include "VSDFieldList.h"
+#include <iostream>

 void libvisio::VSDTextField::handle(VSDCollector *collector) const
 {
@@ -64,10 +66,11 @@ librevenge::RVNGString libvisio::VSDNumericField::datetimeToString(const char *f

 librevenge::RVNGString libvisio::VSDNumericField::getString(const std::map<unsigned, librevenge::RVNGString> &)
 {
-  if (m_format == 0xffff)
-    return librevenge::RVNGString();
+  VSD_DEBUG_MSG(("Converting to string format type: %d\n", m_format));
   switch (m_format)
   {
+  case VSD_FIELD_FORMAT_Unknown:
+    return librevenge::RVNGString();
   case VSD_FIELD_FORMAT_DateMDYY:
   case VSD_FIELD_FORMAT_DateMMDDYY:
   case VSD_FIELD_FORMAT_DateMmmDYYYY:
@@ -141,7 +144,18 @@ librevenge::RVNGString libvisio::VSDNumericField::getString(const std::map<unsig
   default:
   {
     librevenge::RVNGString result;
-    librevenge::RVNGProperty *pProp = librevenge::RVNGPropertyFactory::newDoubleProp(m_number);
+
+    librevenge::RVNGProperty *pProp;
+    double intpart;
+    if (std::modf(m_number, &intpart) == 0.0)
+    {
+      pProp = librevenge::RVNGPropertyFactory::newIntProp(m_number);
+    }
+    else
+    {
+      pProp = librevenge::RVNGPropertyFactory::newDoubleProp(m_number);
+    }
+
     if (pProp)
     {
       result = pProp->getStr();
--
2.17.1
