#!/bin/sh

if test -z "${SRC_ROOT}"; then
    if test -f ./config_build.mk ; then
        sed -e 's/^\s*\(export [A-Z0-9_]*=\)\(.*\)$/\1"\2"/' <config_build.mk >config_build.mk.sh
        . ./config_build.mk.sh
        rm config_build.mk.sh
    else
        if test -f ./config_host.mk ; then
            sed -e 's/^\s*\(export [A-Z0-9_]*=\)\(.*\)$/\1"\2"/' <config_host.mk >config_host.mk.sh
            . ./config_host.mk.sh
            rm config_host.mk.sh
        fi
    fi
fi
if test -z "${SOLARENV}"; then
    echo "bootstrap: No environment set!"
    exit 1
fi

# executables are *.exe for WNT. This variable is necessary since Cygwin 1.5.x
# Use spawn instead of fork when building dmake on cygwin.
if test "$OS_FOR_BUILD" = "WNT"; then
    EXEEXT=".exe"
    DMAKE_CONF="--enable-spawn"
else
    EXEEXT=""
    DMAKE_CONF=""
fi
export EXEEXT

mkdir -p "$SOLARENV/$OUTPATH_FOR_BUILD/bin"

#make sure build.pl is executable

chmod +x "$SRC_ROOT/solenv/bin/build.pl"
chmod +x "$SRC_ROOT/solenv/bin/zipdep.pl"

# Local Variables:
# mode: shell-script
# tab-width: 4
# indent-tabs-mode: nil
# End:

# vim:set shiftwidth=4 softtabstop=4 expandtab:
