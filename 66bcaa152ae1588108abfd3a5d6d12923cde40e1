{
  "comments": [
    {
      "key": {
        "uuid": "7f231b9d_7630b008",
        "filename": "sc/source/ui/condformat/condformatdlg.cxx",
        "patchSetId": 2
      },
      "lineNbr": 270,
      "author": {
        "id": 1000023
      },
      "writtenOn": "2018-10-17T19:44:02Z",
      "side": 1,
      "message": "In URM_MOVE context aRefCxt.maRange is the new target range after the move. But using URM_MOVE and thus ScTokenArray::AdjustReferenceOnMove() is wrong here. That is for moving cells and adjusting references that point into the moved range to move along.",
      "revId": "66bcaa152ae1588108abfd3a5d6d12923cde40e1",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7f231b9d_396fcbc6",
        "filename": "sc/source/ui/condformat/condformatdlg.cxx",
        "patchSetId": 2
      },
      "lineNbr": 270,
      "author": {
        "id": 1000182
      },
      "writtenOn": "2018-10-17T22:05:43Z",
      "side": 1,
      "message": "Oookay, so what is the right operator and/or range for \"please move all relative references in this formula 2 rows down\", for example?",
      "parentUuid": "7f231b9d_7630b008",
      "revId": "66bcaa152ae1588108abfd3a5d6d12923cde40e1",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1f1a1f67_7fc2baeb",
        "filename": "sc/source/ui/condformat/condformatdlg.cxx",
        "patchSetId": 2
      },
      "lineNbr": 270,
      "author": {
        "id": 1000023
      },
      "writtenOn": "2018-10-23T17:53:04Z",
      "side": 1,
      "message": "Bah, my bad. So this could work as intended, but in ScConditionEntry::UpdateReference() for URM_MOVE the old position is also passed as new position to ScTokenArray::AdjustReferenceOnMove(...,rOldPos,rNewPos) so effectively nothing is changed if the reference points outside the moved range.\n\nProbably ScConditionEntry::UpdateReference() in this case needs to calculate the old position also for URM_MOVE, similar to what it does for URM_INSDEL.\n\nThat looks suspicious to me anyway, because the same effect kicks in when cut\u0026paste a cell with conditional format, so the conditional formula does not point to the original cells anymore. But I didn\u0027t check implications it would have when generally changing that. Might be that then is also wrong if a cell is cut from an existing range and the range is not split into several conditional formats.\n\nSo maybe best introduce an optional parameter to ScConditionEntry::UpdateReference() to handle this specific case here.",
      "parentUuid": "7f231b9d_396fcbc6",
      "revId": "66bcaa152ae1588108abfd3a5d6d12923cde40e1",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1f1a1f67_155f2742",
        "filename": "sc/source/ui/condformat/condformatdlg.cxx",
        "patchSetId": 2
      },
      "lineNbr": 270,
      "author": {
        "id": 1000182
      },
      "writtenOn": "2018-10-24T18:34:03Z",
      "side": 1,
      "message": "I tried to approximate what Ctrl-X, Ctrl-V of a range with formula-based conditional formatting does when adjusting references in the formula, but I can\u0027t say I\u0027d know exactly what I\u0027m doing here :|\n\nSo ScConditionEntry::UpdateReference is the right approach, but there\u0027s an issue w/ that function itself in a way it passes new \u0026 old range?",
      "parentUuid": "1f1a1f67_7fc2baeb",
      "revId": "66bcaa152ae1588108abfd3a5d6d12923cde40e1",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7f231b9d_164a9c7f",
        "filename": "sc/source/ui/condformat/condformatdlg.cxx",
        "patchSetId": 2
      },
      "lineNbr": 849,
      "author": {
        "id": 1000023
      },
      "writtenOn": "2018-10-17T19:44:02Z",
      "side": 1,
      "message": "This is only called when the Range edit field loses focus, i.e. when travelling to another dialog element, but not if one just hits Enter after editing the range string.",
      "revId": "66bcaa152ae1588108abfd3a5d6d12923cde40e1",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    }
  ]
}