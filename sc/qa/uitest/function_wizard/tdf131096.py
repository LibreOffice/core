# -*- tab-width: 4; indent-tabs-mode: nil; py-indent-offset: 4 -*-

from uitest.framework import UITestCase
from libreoffice.uno.propertyvalue import mkPropertyValues
from uitest.uihelper.common import get_state_as_dict
import importlib

# Bug 131096 - Calc crashes when viewing details of two Statistical functions
# in Function Wizard.

# This test is auto generated by dsl_core.py using steps from:
# https://wiki.documentfoundation.org/Development/UITests#Tools_for_writing_a_test
# It is modified to remove generic symbol names, add comments and make it work

class Tdf131096(UITestCase):
    def test_tdf131096(self):
        # Open Calc main window
        # FIXME: this script is not working as expected, need info on fix
        # = MainWindow.getChild("")
        #.executeAction("SELECT", mkPropertyValues({"TABLE": "0"}))
        #.executeAction("SELECT", mkPropertyValues({"CELL": "A1"}))
        # Open Formula Wizard (Ctrl+F2)
        self.ui_test.execute_modeless_dialog_through_command(".uno:FunctionDialog")
        FormulaDialog  = self.xUITest.getTopFocusWindow()
        # Open Formula Editor in formula wizard
        ed_formula = FormulaDialog.getChild("ed_formula")
        # Scroll Down on FORECAST.ETS.PI.ADD/FORECAST.ETS.PI.MULT parameters on RHS
        ed_formula.executeAction("TYPE", mkPropertyValues({"KEYCODE": "SHIFT+HOME"}))
        ed_formula.executeAction("TYPE", mkPropertyValues({"KEYCODE": "DELETE"}))
        ed_formula.executeAction("TYPE", mkPropertyValues({"KEYCODE": "BACKSPACE"}))
        # Click ok in formula wizard and close it
        ok = FormulaDialog.getChild("ok")
        self.ui_test.close_dialog_through_button(ok)
        # TODO: Verify no crashes ???
        self.ui_test.close_doc()

# vim: set shiftwidth=4 softtabstop=4 expandtab:
