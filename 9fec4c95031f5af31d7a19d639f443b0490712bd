{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "a0c82fe2_2eff2289",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003564
      },
      "writtenOn": "2022-05-21T08:37:42Z",
      "side": 1,
      "message": "Reviewer can see the ImpDetectEMF function before the regression here:\nhttps://gerrit.libreoffice.org/c/core/+/132456/14/vcl/source/filter/graphicfilter2.cxx",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7a232246_239d0392",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001339
      },
      "writtenOn": "2022-05-23T06:20:35Z",
      "side": 1,
      "message": "Thank you Paris. Great work.\n\nIt would be great if the issue could be covered with test.\n@Xisco Do you know how it could be made?\n",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ad7515b9_4c001df1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003564
      },
      "writtenOn": "2022-05-23T08:58:12Z",
      "side": 1,
      "message": "Thanks for the review.\n\nThe test is something I was looking into, there\u0027s two options the way I see it.\n\n1. Place it inside a new testDetectEMF method in GraphicTest.cxx\n\n2. Create a new file that tests GraphicDescriptor. Because nothing else in GraphicTest tests the GraphicDescriptor and a GraphicDescriptor test file doesn\u0027t exist\n\nLet me know if there\u0027s a better way.",
      "parentUuid": "7a232246_239d0392",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "61bc8349_9cf521dc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000179
      },
      "writtenOn": "2022-05-23T11:47:01Z",
      "side": 1,
      "message": "Hi,\nSince the WMF image inside the file is 2.7 mbs ( too large for a unittest ) I created a minimal pptx reproducer and test it as a sd_import_tests. See https://gerrit.libreoffice.org/c/core/+/134818\nIf there are other ways to test it or make the WMF smaller, I don\u0027t know them",
      "parentUuid": "ad7515b9_4c001df1",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0cb4404a_badae30b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001339
      },
      "writtenOn": "2022-05-23T11:55:10Z",
      "side": 1,
      "message": "I could reduce the WMF image to small size. \nCould you please provide the WMF image for shrinking?",
      "parentUuid": "61bc8349_9cf521dc",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0fb551ad_4ec929a7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000179
      },
      "writtenOn": "2022-05-23T11:56:50Z",
      "side": 1,
      "message": "get the patch \"git fetch https://git.libreoffice.org/core refs/changes/18/134818/1 \u0026\u0026 git cherry-pick FETCH_HEAD\" and the image is inside sd/qa/unit/data/pptx/tdf149206.pptx",
      "parentUuid": "0cb4404a_badae30b",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "785c4f1d_d5e7399b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003564
      },
      "writtenOn": "2022-05-23T12:26:52Z",
      "side": 1,
      "message": "Exporting the image as EMF or WMF from the pptx exports it the same (same size/hash and everything). Also it seems to discard the metadata completely. Possibly a bug? I could look into that and maybe reduce the size of the unit test eventually by compressing the EMF into an EMZ.",
      "parentUuid": "0fb551ad_4ec929a7",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "109bd03f_2fe456a0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000154
      },
      "writtenOn": "2022-05-23T14:00:06Z",
      "side": 1,
      "message": "We also need a test on the low level - testing GraphicDescriptor\u0027s behavior.",
      "parentUuid": "785c4f1d_d5e7399b",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fcf1009b_4aada495",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1003564
      },
      "writtenOn": "2022-05-23T21:08:49Z",
      "side": 1,
      "message": "Added a test case in GraphicDescriptorTest for testing GraphicDescriptors EMF detection. I am reusing TypeDetectionExample.emf, let me know what you think.\n\nPatch: https://gerrit.libreoffice.org/c/core/+/134845",
      "parentUuid": "109bd03f_2fe456a0",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4df82e1f_16ab66e2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001339
      },
      "writtenOn": "2022-05-23T22:15:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fcf1009b_4aada495",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "92de5ebf_76515ba8",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1091,
      "author": {
        "id": 1001339
      },
      "writtenOn": "2022-05-23T06:20:35Z",
      "side": 1,
      "message": "It would be great if the whole method would have the same code formatting (eg. spaces inside brackets).\n\nYou could run `clang-format vcl/source/filter/graphicfilter2.cxx` on that file, and copy paste the method.",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "97f73870_58e5d49e",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1091,
      "author": {
        "id": 1003564
      },
      "writtenOn": "2022-05-23T09:58:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "92de5ebf_76515ba8",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "791ebc1f_c964b042",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1101,
      "author": {
        "id": 1001339
      },
      "writtenOn": "2022-05-23T08:45:01Z",
      "side": 1,
      "message": "It would be great to check if the uncompression was successfull, and return if failed.\n\nFor example:\n\n    if (!aCodec.EndCompression())\n        return false;",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8eaf4631_1b25f050",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1101,
      "author": {
        "id": 1003564
      },
      "writtenOn": "2022-05-23T09:58:32Z",
      "side": 1,
      "message": "I think the check nDecompressLength \u003d\u003d EMF_CHECK_SIZE is enough for checking if the uncompression is successful, as it checks that 44 bytes have been uncompressed, enough to detect EMF files. Let me know if I\u0027m missing something.",
      "parentUuid": "791ebc1f_c964b042",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0e9727da_d04a6fda",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1101,
      "author": {
        "id": 1001339
      },
      "writtenOn": "2022-05-23T10:19:02Z",
      "side": 1,
      "message": "Yes, true. It is enough to just check the size",
      "parentUuid": "8eaf4631_1b25f050",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "847e0adf_72eb9dc6",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1101,
      "author": {
        "id": 1001339
      },
      "writtenOn": "2022-05-23T10:24:54Z",
      "side": 1,
      "message": "In my opinion if decompression was failed (eg. size is different than EMF_CHECK_SIZE), we should stop analysing file and return false.",
      "parentUuid": "0e9727da_d04a6fda",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "93ce41f1_1072cf7d",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1101,
      "author": {
        "id": 1003564
      },
      "writtenOn": "2022-05-23T11:03:03Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "847e0adf_72eb9dc6",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fe4fa921_8dbdee79",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1116,
      "author": {
        "id": 1001339
      },
      "writtenOn": "2022-05-23T06:20:35Z",
      "side": 1,
      "message": "It would be great to avoid using magic numbers.\nThis record is called EMR_HEADER. Can you define constexp for that.\n(The usage the same field from emfio/source/reader/emfreader.cxx would be too much work for this PR).",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2330231a_647172d6",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1116,
      "author": {
        "id": 1001339
      },
      "writtenOn": "2022-05-23T06:26:15Z",
      "side": 1,
      "message": "More information about different record types:\nhttps://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-emf/1eec80ba-799b-4784-a9ac-91597d590ae1",
      "parentUuid": "fe4fa921_8dbdee79",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b9173f36_d50e8b1b",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1116,
      "author": {
        "id": 1003564
      },
      "writtenOn": "2022-05-23T09:58:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2330231a_647172d6",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "188ebe05_0948b6a0",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1122,
      "author": {
        "id": 1003564
      },
      "writtenOn": "2022-05-21T08:37:42Z",
      "side": 1,
      "message": "This was a ReadInt32 normally but the int it reads to is unused so I thought to change it to this instead.",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cca6fcaf_e6b54736",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1133,
      "author": {
        "id": 1001339
      },
      "writtenOn": "2022-05-23T06:26:15Z",
      "side": 1,
      "message": "More information about this magic number is here:\nhttps://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-emf/b55cbd24-612d-47fe-81c9-1da6a682246f\nPlease replace is with constexpr or enum.",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b68de971_49a53113",
        "filename": "vcl/source/filter/graphicfilter2.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1133,
      "author": {
        "id": 1003564
      },
      "writtenOn": "2022-05-23T09:58:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "cca6fcaf_e6b54736",
      "revId": "9fec4c95031f5af31d7a19d639f443b0490712bd",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    }
  ]
}