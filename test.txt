
static bool ImplKillTrailingWithExceptions( OUString& rName, const char* const* ppStr )
{
    for(; *ppStr; ++ppStr )
    {
        sal_Int32 nTrailLen = ImplIsTrailing( rName, *ppStr );
        if( nTrailLen )
        {
            // check string match against string exceptions
            while( *++ppStr )
            {
                // if the name is the same as the string exception, then skip it
                // for example - we have a caps font family, but without this check it
                // will stripped
                OUString sException(*ppStr, strlen(*ppStr), RTL_TEXTENCODING_MS_1252);

               if (rName == sException)
                    return false;

                if (ImplIsTrailing(rName, *ppStr))
                    return false;
            }

            rName = rName.copy(0, rName.getLength() - nTrailLen );
            return true;
        }
        else
        {
            // skip exception strings
            while( *++ppStr ) {}
        }
    }

    return false;
}
