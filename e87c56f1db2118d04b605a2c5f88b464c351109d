{
  "comments": [
    {
      "key": {
        "uuid": "5f4e5783_cbd8e980",
        "filename": "vcl/unx/gtk3_kde5/gtk3_kde5_filepicker_ipc.cxx",
        "patchSetId": 3
      },
      "lineNbr": 141,
      "author": {
        "id": 1000562
      },
      "writtenOn": "2018-12-03T19:39:02Z",
      "side": 1,
      "message": "If I read http://man7.org/linux/man-pages/man7/pipe.7.html correctly the ::Quit is not needed. Just close the pipe and the other process will read eof(). As I understand the manpage, the reading process will instantly get eof(), but in any way the Quit() is superfluous.\n\nClosing the pipe before trying to join is definitely the way to go.",
      "range": {
        "startLine": 141,
        "startChar": 0,
        "endLine": 141,
        "endChar": 32
      },
      "revId": "e87c56f1db2118d04b605a2c5f88b464c351109d",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5f4e5783_2be9bd7f",
        "filename": "vcl/unx/gtk3_kde5/gtk3_kde5_filepicker_ipc.cxx",
        "patchSetId": 3
      },
      "lineNbr": 141,
      "author": {
        "id": 1000789
      },
      "writtenOn": "2018-12-04T06:41:31Z",
      "side": 1,
      "message": "AFAIU the \"::Quit\" is part of the \"IPC protocol\" being used here and is needed for the kde5_filepicker process (main thread) to know it should terminate itself, s. kde5_filepicker_ipc.cxx:370-374. If I remove it here, it doesn\u0027t terminate itself properly (just verified e.g. that the destructor \u0027FilePickerIpc::~FilePickerIpc\u0027 is not called at all) and needs to be terminated below.",
      "parentUuid": "5f4e5783_cbd8e980",
      "range": {
        "startLine": 141,
        "startChar": 0,
        "endLine": 141,
        "endChar": 32
      },
      "revId": "e87c56f1db2118d04b605a2c5f88b464c351109d",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5f4e5783_6bd1f557",
        "filename": "vcl/unx/gtk3_kde5/kde5_filepicker_ipc.cxx",
        "patchSetId": 3
      },
      "lineNbr": 195,
      "author": {
        "id": 1000562
      },
      "writtenOn": "2018-12-03T19:39:02Z",
      "side": 1,
      "message": "This check should go before readCommand. AFAIK the result of the read is undefined, if the pipe is closed and the result of eof() is instantly true. But please verify this, as this is just the gist of how I understood the stackexchange and c++ reference texts.",
      "range": {
        "startLine": 195,
        "startChar": 0,
        "endLine": 195,
        "endChar": 27
      },
      "revId": "e87c56f1db2118d04b605a2c5f88b464c351109d",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5f4e5783_4bf4f95b",
        "filename": "vcl/unx/gtk3_kde5/kde5_filepicker_ipc.cxx",
        "patchSetId": 3
      },
      "lineNbr": 195,
      "author": {
        "id": 1000789
      },
      "writtenOn": "2018-12-04T06:41:31Z",
      "side": 1,
      "message": "https://en.cppreference.com/w/cpp/io/basic_istream/operator_gtgt says: \"If extraction fails, zero is written to value and failbit is set. If extraction results in the value too large or too small to fit in value, std::numeric_limits\u003cT\u003e::max() or std::numeric_limits\u003cT\u003e::min() is written and failbit flag is set.\" I\u0027m not totally sure whether \"extraction fails\" applies here, but at least I observe that both values are 0 when I look at them.\n\nThe check can for sure be moved above the \u0027readCommandArgs\u0027, but I think that moving it in front of \u0027readIpcArg\u0027 (or at the beginning of that function) has the problem that eof() will return \u0027false\u0027 when the pipe has not been closed yet, so the read will be done nonetheless (blocking until EOF is received when the pipe is finally closed), so the check here (or right after the \u0027readIpcArgs\u0027 call would still be needed.",
      "parentUuid": "5f4e5783_6bd1f557",
      "range": {
        "startLine": 195,
        "startChar": 0,
        "endLine": 195,
        "endChar": 27
      },
      "revId": "e87c56f1db2118d04b605a2c5f88b464c351109d",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    }
  ]
}