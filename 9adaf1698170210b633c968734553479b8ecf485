{
  "comments": [
    {
      "key": {
        "uuid": "3fa0c359_cc13fb5b",
        "filename": "vcl/qt5/Qt5FilePicker.cxx",
        "patchSetId": 2
      },
      "lineNbr": 268,
      "author": {
        "id": 1000083
      },
      "writtenOn": "2019-06-19T13:49:48Z",
      "side": 1,
      "message": "part of this comment doesn\u0027t make sense if \"pathnames containing byte sequences that are not valid UTF-8 are apparently filtered out and not even displayed by QFileDialog\", then how can QUrl ever contain the pathnames byte sequence if that pathname is not utf-8?",
      "revId": "9adaf1698170210b633c968734553479b8ecf485",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1f9dbf25_1b089b26",
        "filename": "vcl/qt5/Qt5FilePicker.cxx",
        "patchSetId": 2
      },
      "lineNbr": 268,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2019-06-19T14:04:02Z",
      "side": 1,
      "message": "I guess I don\u0027t understand your question.  A pathname like /.../\\x80 (with a last filename segment containing just the non--UTF-8 byte 0x80) is just not displayed at all by QFileDialog, and QFileDialog::selectedUrls will thus never return a QUrl representing it.",
      "parentUuid": "3fa0c359_cc13fb5b",
      "revId": "9adaf1698170210b633c968734553479b8ecf485",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1f9dbf25_db3a33cc",
        "filename": "vcl/qt5/Qt5FilePicker.cxx",
        "patchSetId": 2
      },
      "lineNbr": 268,
      "author": {
        "id": 1000083
      },
      "writtenOn": "2019-06-19T14:13:28Z",
      "side": 1,
      "message": "It\u0027s the \"so\", which confuses me, because it implies that the second half of the sentence logically flows from the first half :-)\n\nThe condition that we never see non-utf-8 data is enforced by the QFileDialog action of filtering out such non-utf-8 data.\n\nThe condition that QUrl contains the raw pathname bytes, is I suppose, enforced by a combination of QUrl and QFileDialog, but I don\u0027t see it documented anywhere.",
      "parentUuid": "1f9dbf25_1b089b26",
      "revId": "9adaf1698170210b633c968734553479b8ecf485",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff6b8bd7_9a1b4d72",
        "filename": "vcl/qt5/Qt5FilePicker.cxx",
        "patchSetId": 2
      },
      "lineNbr": 268,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2019-06-19T14:41:57Z",
      "side": 1,
      "message": "QUrl::toEncoded is documented (at \u003chttps://doc.qt.io/qt-5/qurl.html#toEncoded\u003e) as: \"The user info, path and fragment are all converted to UTF-8\".  Together with the stated observation that \"QFileDialog [...] apparently always treats file-system pathnames as UTF-8--encoded\", that should imply that, for a pathname with valid UTF-8 bytes, aURL.toEncoded() will have those pathname bytes as payload.\n\nWhich leaves the question what aURL.toEncoded() would return for pathnames with invalid UTF-8 bytes.  That\u0027s where the second observation (\"pathnames containing byte sequences that are not valid UTF-8 are apparently filtered out\") comes in.\n\nAnd together, those two points imply \"so aURL will always have a \u0027payload\u0027 that matches the pathname\u0027s byte sequence.\"",
      "parentUuid": "1f9dbf25_db3a33cc",
      "revId": "9adaf1698170210b633c968734553479b8ecf485",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3fa0c359_ac18ef74",
        "filename": "vcl/qt5/Qt5FilePicker.cxx",
        "patchSetId": 2
      },
      "lineNbr": 278,
      "author": {
        "id": 1000083
      },
      "writtenOn": "2019-06-19T13:49:48Z",
      "side": 1,
      "message": "surely this message should be \n\n    \"cannot convert ... from utf-8 encoding to internal encoding\"\n\nsince toEncoded() always returns utf-8 ?",
      "revId": "9adaf1698170210b633c968734553479b8ecf485",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1f9dbf25_3b0d5737",
        "filename": "vcl/qt5/Qt5FilePicker.cxx",
        "patchSetId": 2
      },
      "lineNbr": 278,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2019-06-19T14:04:02Z",
      "side": 1,
      "message": "No.  As the comment explains (or at least tries to), the payload bytes of aURL are the raw pathname bytes, what LO considers the \"external URL\" or \"locale encoding\".  (While the \"internal URL\" is UTF-8 encoded.)",
      "parentUuid": "3fa0c359_ac18ef74",
      "revId": "9adaf1698170210b633c968734553479b8ecf485",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": false
    }
  ]
}