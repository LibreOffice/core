{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f94ef340_3dfbdcb0",
        "filename": "sc/source/core/data/documen3.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1918,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2022-07-23T16:44:01Z",
      "side": 1,
      "message": "IsDocEditable considers IsDocProtected, and *also* other things, mpShell-\u003eIsReadOnly() among them.",
      "revId": "af86b4e10943a333af224bed450e7b82bcf02a7a",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b57f9c06_0a6484f6",
        "filename": "sc/source/core/data/documen3.cxx",
        "patchSetId": 1
      },
      "lineNbr": 1918,
      "author": {
        "id": 1002951
      },
      "writtenOn": "2022-07-23T18:01:39Z",
      "side": 1,
      "message": "I think GetDocument().IsDocEditable() is well suited, not only because Heiko suggested it in the Bugzilla, but also because it is used in ScDocFunc::RenameTable() which is invoked when you want to rename a sheet.",
      "parentUuid": "f94ef340_3dfbdcb0",
      "revId": "af86b4e10943a333af224bed450e7b82bcf02a7a",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "759a8ca0_354048f7",
        "filename": "sc/source/ui/view/tabview5.cxx",
        "patchSetId": 1
      },
      "lineNbr": 363,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2022-07-23T09:05:45Z",
      "side": 1,
      "message": "(Reviewing on the go, can\u0027t check the difference myself)\n\nHere GetSfxDocShell()-\u003eIsReadOnly is used; below you use GetDocument().IsDocEditable. Depending on implementation, these can be different. Any reason to not use the former?",
      "revId": "af86b4e10943a333af224bed450e7b82bcf02a7a",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0ad8633c_4236c1c4",
        "filename": "sc/source/ui/view/tabview5.cxx",
        "patchSetId": 1
      },
      "lineNbr": 363,
      "author": {
        "id": 1002951
      },
      "writtenOn": "2022-07-23T12:14:08Z",
      "side": 1,
      "message": "The GetSfxDocShell()-\u003eIsReadOnly is something else, unrelated to \"Protect Spreadsheet Structure...\". I have used it instead of GetDocument().IsDocEditable, and it didn\u0027t work as intended here.\nI have used +w and -w permissions for an ods file, tested it in a debug session. GetSfxDocShell()-\u003eIsReadOnly exactly reflected that permission.",
      "parentUuid": "759a8ca0_354048f7",
      "revId": "af86b4e10943a333af224bed450e7b82bcf02a7a",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c3af97ab_b5e81c2e",
        "filename": "sc/source/ui/view/tabview5.cxx",
        "patchSetId": 1
      },
      "lineNbr": 386,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2022-07-23T16:44:01Z",
      "side": 1,
      "message": "Aha, thanks; but IsDocEditable is wrong, too: maybe what you wanted was IsDocProtected?",
      "revId": "af86b4e10943a333af224bed450e7b82bcf02a7a",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3bd70725_a9c26833",
        "filename": "sc/source/ui/view/tabview5.cxx",
        "patchSetId": 1
      },
      "lineNbr": 386,
      "author": {
        "id": 1002951
      },
      "writtenOn": "2022-07-23T18:01:39Z",
      "side": 1,
      "message": "With the above note, I think the GetDocument().IsDocEditable() is the correct choice. It does additional checks, but that should be fine.",
      "parentUuid": "c3af97ab_b5e81c2e",
      "revId": "af86b4e10943a333af224bed450e7b82bcf02a7a",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2c3b263e_fee31ba9",
        "filename": "sc/source/ui/view/tabview5.cxx",
        "patchSetId": 1
      },
      "lineNbr": 386,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2022-07-23T20:20:37Z",
      "side": 1,
      "message": "I do not quite get it: are you saying that IsDocEditable \"is the correct choice\" (i.e., it makes the *correct* checks), or are you telling that the additional (unneeded) checks are done in it, but these extra checks are OK (because of what? On that logic, we can stop caring about correctness, and start inserting extra checks left and right).\n\nUnCCing myself - I can\u0027t review such an approach. You have commit rights anyway.",
      "parentUuid": "3bd70725_a9c26833",
      "revId": "af86b4e10943a333af224bed450e7b82bcf02a7a",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    }
  ]
}