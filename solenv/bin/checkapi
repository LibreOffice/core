#!/bin/sh
PS=":"
# cygwin:
if [ "$GUI" = "WNT" ]; then
    PS=";"
fi

JARFOLDER=$SOLARVERSION/$INPATH/bin$UPDMINOREXT
SOLVER_LIB=$SOLARVERSION/$INPATH/lib$UPDMINOREXT

# it is possible to give an other OOoRunner.jar
if [ -n "$RUNNERJAR" ]; then
    myCLASSPATH=$RUNNERJAR
else 
    myCLASSPATH=$JARFOLDER/OOoRunner.jar
fi

myCLASSPATH=$myCLASSPATH${PS}${JARFOLDER}/ridl.jar${PS}${JARFOLDER}/unoil.jar${PS}${JARFOLDER}/jurt.jar${PS}${JARFOLDER}/juh.jar${PS}${JARFOLDER}/java_uno.jar
myCLASSPATH=$myCLASSPATH${PS}/net/unoapi/export/unoapi/bin/mysql.jar${PS}$SOLVER_LIB

if [ -n "$JAVAI" ]; then
	JAVABIN=$JAVAI
elif [ -n "$JAVA_HOME" ]; then
    if [ "$OS$CPUNAME$CPU" = SOLARISSPARCU ]; then
        JAVABIN=$JAVA_HOME/bin/sparcv9/java
    else
        JAVABIN=$JAVA_HOME/bin/java
    fi
else
    # there seems to be some machines without real java
    JAVABIN=$(which java)
    if [ -z "$JAVABIN" ]; then 
        echo "please set environment variable JAVA_HOME"
        exit 1
    fi
fi

if [ x${USER}x = xx ]; then
    if [ x${LOGNAME}x = xx ]; then
        echo "ERROR: could not determine username. Please export variable USER" >&2
        exit $EXIT_FAILURE
    else 
        USER=$LOGNAME
        export USER
    fi
fi

PARAM="-cs pipe,name=$USER -SRC_ROOT $SRC_ROOT"

if [ -n "$RUNNERPROPS" ]; then
    PARAM="$PARAM -runnerini $RUNNERPROPS"
fi

MYXDEBUG=""
if [ -n "$XDEBUG" ]; then
    # export XDEBUG="-Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=8001" 
    MYXDEBUG=$XDEBUG
fi

COMMAND="$JAVABIN -Xmx120m $MYXDEBUG -cp $myCLASSPATH org.openoffice.Runner $PARAM $*"
echo $COMMAND
$COMMAND
