{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "8809e8ad_fb267015",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2021-12-16T12:08:16Z",
      "side": 1,
      "message": "This caused \u003chttps://ci.libreoffice.org//job/lo_ubsan/2233/consoleFull#-14523843999567f988-cbcf-4519-af05-6000b834f13f\u003e to fail during the new UITest_writer_tests UITEST_TEST_NAME\u003dtdf145062.Tdf145062.test_tdf145062 with\n\n  /sw/source/ui/fldui/fldref.cxx:470:32: runtime error: downcast of address 0x60700065f330 which does not point to an object of type \u0027SwGetRefField\u0027\n  0x60700065f330: note: object is of type \u0027SwInputField\u0027\n   a8 04 00 78  30 d8 f7 f1 8c 2b 00 00  60 9a d4 4c 8c 2b 00 00  00 b6 57 00 10 61 00 00  00 00 00 00\n                ^~~~~~~~~~~~~~~~~~~~~~~\n                vptr for \u0027SwInputField\u0027\n      #0 0x2b917d44b1fc in SwFieldRefPage::UpdateSubType(rtl::OUString const\u0026) /sw/source/ui/fldui/fldref.cxx:470:32\n      #1 0x2b917d463aa9 in SwFieldRefPage::TypeHdl(weld::TreeView\u0026) /sw/source/ui/fldui/fldref.cxx:358:5\n      #2 0x2b917d45f9e4 in SwFieldRefPage::Reset(SfxItemSet const*) /sw/source/ui/fldui/fldref.cxx:258:5\n      #3 0x2b917d436efd in SwFieldPage::EditNewField(bool) /sw/source/ui/fldui/fldpage.cxx:110:5\n      #4 0x2b917d48e725 in SwFieldDlg::ReInitTabPage(std::basic_string_view\u003cchar, std::char_traits\u003cchar\u003e \u003e, bool) /sw/source/ui/fldui/fldtdlg.cxx:214:16\n      #5 0x2b917d48f411 in SwFieldDlg::Activate() /sw/source/ui/fldui/fldtdlg.cxx:233:9\n      #6 0x2b8cecac5ed0 in SwChildWinWrapper::UpdateHdl(Timer*) /sw/source/uibase/fldui/fldwrap.cxx:42:26\n      #7 0x2b8cecac5afa in SwChildWinWrapper::LinkStubUpdateHdl(void*, Timer*) /sw/source/uibase/fldui/fldwrap.cxx:39:1\n      #8 0x2b8c8ac6fd61 in Link\u003cTimer*, void\u003e::Call(Timer*) const /include/tools/link.hxx:111:45\n      #9 0x2b8c8ac6f2b8 in Timer::Invoke() /vcl/source/app/timer.cxx:75:21\n      #10 0x2b8c8aab22ee in Scheduler::CallbackTaskScheduling() /vcl/source/app/scheduler.cxx:472:16\n      #11 0x2b8c8bcfdda0 in SalTimer::CallCallback() /vcl/inc/saltimer.hxx:54:13\n      #12 0x2b8c8bcf0e7c in SvpSalInstance::CheckTimeout(bool) /vcl/headless/svpinst.cxx:213:53\n      #13 0x2b8c8bcf7dbe in SvpSalInstance::ImplYield(bool, bool) /vcl/headless/svpinst.cxx:453:17\n      #14 0x2b8c8bcfa5c1 in SvpSalInstance::DoYield(bool, bool) /vcl/headless/svpinst.cxx:525:21\n      #15 0x2b8c8abafaa9 in ImplYield(bool, bool) /vcl/source/app/svapp.cxx:465:48\n      #16 0x2b8c8abaec67 in Application::Yield() /vcl/source/app/svapp.cxx:532:5\n      #17 0x2b8c87842191 in Dialog::Execute() /vcl/source/window/dialog.cxx:1056:9\n      #18 0x2b8c8a7bfabd in SalInstanceDialog::run() /vcl/source/app/salvtables.cxx:1685:23\n      #19 0x2b917cc6879c in weld::DialogController::run() /include/vcl/weld.hxx:2516:47\n      #20 0x2b917cf6e99c in SwFieldInputDlg::run() /sw/source/uibase/inc/inpdlg.hxx:56:47\n      #21 0x2b917cf4a47f in AbstractFieldInputDlg_Impl::Execute() /sw/source/ui/dialog/swdlgfact.cxx:223:20\n      #22 0x2b8cedd55e40 in SwWrtShell::StartInputFieldDlg(SwField*, bool, bool, weld::Widget*, SwWrtShell::FieldDialogPressedButton*) /sw/source/uibase/wrtsh/wrtsh2.cxx:274:36\n      #23 0x2b8cecab4428 in SwFieldMgr::InsertField(SwInsertField_Data const\u0026) /sw/source/uibase/fldui/fldmgr.cxx:1501:24\n      #24 0x2b917d4380a7 in SwFieldPage::InsertField(SwFieldTypesEnum, unsigned short, rtl::OUString const\u0026, rtl::OUString const\u0026, unsigned int, char16_t, bool) /sw/source/ui/fldui/fldpage.cxx:127:16\n      #25 0x2b917d42f02e in SwFieldFuncPage::FillItemSet(SfxItemSet*) /sw/source/ui/fldui/fldfunc.cxx:568:9\n      #26 0x2b917d48c49d in SwFieldDlg::OKHdl(weld::Button\u0026) /sw/source/ui/fldui/fldtdlg.cxx:164:16\n      #27 0x2b917d48975a in SwFieldDlg::LinkStubOKHdl(void*, weld::Button\u0026) /sw/source/ui/fldui/fldtdlg.cxx:158:1\n      #28 0x2b8c8a98c2b9 in Link\u003cweld::Button\u0026, void\u003e::Call(weld::Button\u0026) const /include/tools/link.hxx:111:45\n      #29 0x2b8c8a920dfe in weld::Button::signal_clicked() /include/vcl/weld.hxx:1410:41\n      #30 0x2b8c8a7d65f6 in SalInstanceButton::ClickHdl(Button*) /vcl/source/app/salvtables.cxx:2667:5\n      #31 0x2b8c8a7d16fa in SalInstanceButton::LinkStubClickHdl(void*, Button*) /vcl/source/app/salvtables.cxx:2655:1\n      #32 0x2b8c88362aa1 in Link\u003cButton*, void\u003e::Call(Button*) const /include/tools/link.hxx:111:45\n      #33 0x2b8c8834ae6b in Button::Click()::$_0::operator()() const /vcl/source/control/button.cxx:130:87\n      #34 0x2b8c8834a8b1 in std::_Function_handler\u003cvoid (), Button::Click()::$_0\u003e::_M_invoke(std::_Any_data const\u0026) /home/tdf/lode/opt_private/gcc-7.3.0/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../include/c++/7.3.0/bits/std_function.h:316:2\n      #35 0x2b8c88455ff1 in std::function\u003cvoid ()\u003e::operator()() const /home/tdf/lode/opt_private/gcc-7.3.0/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../include/c++/7.3.0/bits/std_function.h:706:14\n      #36 0x2b8c8844b0ef in Control::ImplCallEventListenersAndHandler(VclEventId, std::function\u003cvoid ()\u003e const\u0026) /vcl/source/control/ctrl.cxx:310:13\n      #37 0x2b8c882d1836 in Button::Click() /vcl/source/control/button.cxx:130:5\n      #38 0x2b8c8b6db89e in ButtonUIObject::execute(rtl::OUString const\u0026, std::__debug::map\u003crtl::OUString, rtl::OUString, std::less\u003crtl::OUString\u003e, std::allocator\u003cstd::pair\u003crtl::OUString const, rtl::OUString\u003e \u003e \u003e const\u0026) /vcl/source/uitest/uiobject.cxx:624:19\n      #39 0x2b8c8b75a289 in UIObjectUnoObj::executeAction(rtl::OUString const\u0026, com::sun::star::uno::Sequence\u003ccom::sun::star::beans::PropertyValue\u003e const\u0026)::$_0::operator()() const /vcl/source/uitest/uno/uiobject_uno.cxx:137:16\n      #40 0x2b8c8b7593c1 in std::_Function_handler\u003cvoid (), UIObjectUnoObj::executeAction(rtl::OUString const\u0026, com::sun::star::uno::Sequence\u003ccom::sun::star::beans::PropertyValue\u003e const\u0026)::$_0\u003e::_M_invoke(std::_Any_data const\u0026) /home/tdf/lode/opt_private/gcc-7.3.0/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../include/c++/7.3.0/bits/std_function.h:316:2\n      #41 0x2b8c88455ff1 in std::function\u003cvoid ()\u003e::operator()() const /home/tdf/lode/opt_private/gcc-7.3.0/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../include/c++/7.3.0/bits/std_function.h:706:14\n      #42 0x2b8c8b758d2d in (anonymous namespace)::ExecuteWrapper::ExecuteActionHdl(Timer*) /vcl/source/uitest/uno/uiobject_uno.cxx:102:13\n      #43 0x2b8c8b7554f4 in (anonymous namespace)::ExecuteWrapper::LinkStubExecuteActionHdl(void*, Timer*) /vcl/source/uitest/uno/uiobject_uno.cxx:97:1\n      #44 0x2b8c8ac6fd61 in Link\u003cTimer*, void\u003e::Call(Timer*) const /include/tools/link.hxx:111:45\n      #45 0x2b8c8ac6f2b8 in Timer::Invoke() /vcl/source/app/timer.cxx:75:21\n      #46 0x2b8c8aab22ee in Scheduler::CallbackTaskScheduling() /vcl/source/app/scheduler.cxx:472:16\n      #47 0x2b8c8bcfdda0 in SalTimer::CallCallback() /vcl/inc/saltimer.hxx:54:13\n      #48 0x2b8c8bcf0e7c in SvpSalInstance::CheckTimeout(bool) /vcl/headless/svpinst.cxx:213:53\n      #49 0x2b8c8bcf7dbe in SvpSalInstance::ImplYield(bool, bool) /vcl/headless/svpinst.cxx:453:17\n      #50 0x2b8c8bcfa5c1 in SvpSalInstance::DoYield(bool, bool) /vcl/headless/svpinst.cxx:525:21\n      #51 0x2b8c8abafaa9 in ImplYield(bool, bool) /vcl/source/app/svapp.cxx:465:48\n      #52 0x2b8c8abaec67 in Application::Yield() /vcl/source/app/svapp.cxx:532:5\n      #53 0x2b8c8abae8a8 in Application::Execute() /vcl/source/app/svapp.cxx:444:9\n      #54 0x2b8c4d2d7ff1 in desktop::Desktop::Main() /desktop/source/app/app.cxx:1601:13\n      #55 0x2b8c8ac58379 in ImplSVMain() /vcl/source/app/svmain.cxx:199:35\n      #56 0x2b8c8ac614d0 in SVMain() /vcl/source/app/svmain.cxx:231:12\n      #57 0x2b8c4d4d1295 in soffice_main /desktop/source/app/sofficemain.cxx:98:12\n      #58 0x4efc6c in sal_main /desktop/source/app/main.c:51:15\n      #59 0x4efc46 in main /desktop/source/app/main.c:49:1\n      #60 0x2b8c4f0e2554 in __libc_start_main /usr/src/debug/glibc-2.17-c758a686/csu/../csu/libc-start.c:266\n      #61 0x41b5c1 in _start (/instdir/program/soffice.bin+0x41b5c1)\n\nI couldn\u0027t reproduce that failure with a local ASan+UBSan build, and given that it fires from a Timer::Invoke it may be some race?  Also, no idea if this is an issue with the test code or rather uncovers a bug in the Writer code itself.",
      "revId": "deea3b7471c3dab0220eca6146c225a2d47681a2",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "562144a1_65d0c117",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2021-12-17T12:48:25Z",
      "side": 1,
      "message": "\u003e This caused \u003chttps://ci.libreoffice.org//job/lo_ubsan/2233/consoleFull#-14523843999567f988-cbcf-4519-af05-6000b834f13f\u003e to fail during the new UITest_writer_tests UITEST_TEST_NAME\u003dtdf145062.Tdf145062.test_tdf145062 with\n[...]\n\nMichael, maybe you have an idea here, seeing that you provided the fix for the corresponding \u003chttps://bugs.documentfoundation.org/show_bug.cgi?id\u003d145062\u003e \"Crash when inserting hidden field over input field\".",
      "parentUuid": "8809e8ad_fb267015",
      "revId": "deea3b7471c3dab0220eca6146c225a2d47681a2",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "853e144e_a7b04803",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2021-12-17T13:00:57Z",
      "side": 1,
      "message": "(Also, at \u003chttps://ci.libreoffice.org//job/lo_ubsan/2234/consoleFull#40018799748ce9c26-9d0a-43a8-83d8-c44f54920d59\u003e, this test was killed by the kill-wrapper, with the python.bin process at\n\n  Thread 1 (Thread 0x2b8a9e0cc300 (LWP 11288)):\n  Traceback (most recent call first):\n    \u003cbuilt-in method sleep of module object at remote 0x60c000090d30\u003e\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/uitest/uitest/test.py\", line 140, in execute_dialog_through_command\n      time.sleep(DEFAULT_SLEEP)\n    \u003cbuilt-in method next of module object at remote 0x60c0000545b0\u003e\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/python-core-3.8.10/lib/contextlib.py\", line 113, in __enter__\n      return next(self.gen)\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/uitest/uitest/test.py\", line 144, in execute_modeless_dialog_through_command\n      with self.execute_dialog_through_command(command, printNames, close_button, \"ModelessDialogVisible\") as xDialog:\n    \u003cbuilt-in method next of module object at remote 0x60c0000545b0\u003e\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/python-core-3.8.10/lib/contextlib.py\", line 113, in __enter__\n      return next(self.gen)\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/sw/qa/uitest/writer_tests/tdf145062.py\", line 21, in test_tdf145062\n      with self.ui_test.execute_modeless_dialog_through_command(\".uno:InsertField\", close_button\u003d\"\") as xDialog:\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/python-core-3.8.10/lib/unittest/case.py\", line 633, in _callTestMethod\n      method()\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/python-core-3.8.10/lib/unittest/case.py\", line 1700, in run\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/python-core-3.8.10/lib/unittest/case.py\", line 736, in __call__\n      return self.run(*args, **kwds)\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/python-core-3.8.10/lib/unittest/suite.py\", line 378, in run\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/python-core-3.8.10/lib/unittest/suite.py\", line 84, in __call__\n      return self.run(*args, **kwds)\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/python-core-3.8.10/lib/unittest/runner.py\", line 432, in run\n    File \"/home/tdf/lode/jenkins/workspace/lo_ubsan/uitest/test_main.py\", line 129, in \u003cmodule\u003e\n      result \u003d unittest.TextTestRunner(stream\u003dsys.stdout, verbosity\u003d2).run(test_suite)\n\nand the soffice.bin process was idling at\n\n  Thread 1 (Thread 0x2adb617e9040 (LWP 5666)):\n  #0  pthread_cond_timedwait@@GLIBC_2.3.2 () at ../nptl/sysdeps/unix/sysv/linux/x86_64/pthread_cond_timedwait.S:238\n  #1  0x00002adba20160fd in __gthread_cond_timedwait(pthread_cond_t*, pthread_mutex_t*, timespec const*) () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #2  0x00002adba2019a13 in std::cv_status std::condition_variable::__wait_until_impl\u003cstd::chrono::duration\u003clong, std::ratio\u003c1l, 1000000000l\u003e \u003e \u003e(std::unique_lock\u003cstd::mutex\u003e\u0026, std::chrono::time_point\u003cstd::chrono::_V2::system_clock, std::chrono::duration\u003clong, std::ratio\u003c1l, 1000000000l\u003e \u003e \u003e const\u0026) () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #3  0x00002adba2019505 in std::cv_status std::condition_variable::wait_until\u003cstd::chrono::duration\u003clong, std::ratio\u003c1l, 1000000000l\u003e \u003e \u003e(std::unique_lock\u003cstd::mutex\u003e\u0026, std::chrono::time_point\u003cstd::chrono::_V2::system_clock, std::chrono::duration\u003clong, std::ratio\u003c1l, 1000000000l\u003e \u003e \u003e const\u0026) () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #4  0x00002adba2015dd5 in bool std::condition_variable::wait_until\u003cstd::chrono::_V2::system_clock, std::chrono::duration\u003clong, std::ratio\u003c1l, 1000000000l\u003e \u003e, SvpSalInstance::ImplYield(bool, bool)::$_2\u003e(std::unique_lock\u003cstd::mutex\u003e\u0026, std::chrono::time_point\u003cstd::chrono::_V2::system_clock, std::chrono::duration\u003clong, std::ratio\u003c1l, 1000000000l\u003e \u003e \u003e const\u0026, SvpSalInstance::ImplYield(bool, bool)::$_2) () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #5  0x00002adba2012f3f in bool std::condition_variable::wait_for\u003clong, std::ratio\u003c1l, 1000l\u003e, SvpSalInstance::ImplYield(bool, bool)::$_2\u003e(std::unique_lock\u003cstd::mutex\u003e\u0026, std::chrono::duration\u003clong, std::ratio\u003c1l, 1000l\u003e \u003e const\u0026, SvpSalInstance::ImplYield(bool, bool)::$_2) () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #6  0x00002adba2012781 in SvpSalInstance::ImplYield(bool, bool) () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #7  0x00002adba20138a2 in SvpSalInstance::DoYield(bool, bool) () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #8  0x00002adba0ec8d8a in ImplYield(bool, bool) () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #9  0x00002adba0ec7f48 in Application::Yield() () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #10 0x00002adba0ec7b89 in Application::Execute() () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #11 0x00002adb628c7412 in desktop::Desktop::Main() () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libsofficeapp.so\n  #12 0x00002adba0f7165a in ImplSVMain() () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #13 0x00002adba0f7a7b1 in SVMain() () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libvcllo.so\n  #14 0x00002adb62ac06b6 in soffice_main () from /home/tdf/lode/jenkins/workspace/lo_ubsan/instdir/program/libsofficeapp.so\n  #15 0x00000000004efc6d in sal_main () at desktop/source/app/main.c:51\n  #16 0x00000000004efc47 in main (argc\u003d7, argv\u003d0x7ffc1cebe778) at desktop/source/app/main.c:49\n\n)",
      "revId": "deea3b7471c3dab0220eca6146c225a2d47681a2",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d2453f1b_22eb6162",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000022
      },
      "writtenOn": "2021-12-17T13:16:08Z",
      "side": 1,
      "message": "oops, that was a misclick",
      "revId": "deea3b7471c3dab0220eca6146c225a2d47681a2",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e1bdacee_2e9aaed9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000022
      },
      "writtenOn": "2021-12-17T14:00:05Z",
      "side": 1,
      "message": "so the timer ends up doing \"m_pCurField \u003d pSh-\u003eGetCurField( true )\"\n\nvia SwFieldPage::Init() called from SwFieldDlg::ReInitTabPage()\n\nas such any static_cast of m_pCurField is bogus, no guarantees can be made about the type of the object it points to\n\nsee also fldref.cxx:292 where it\u0027s already dynamic_cast",
      "revId": "deea3b7471c3dab0220eca6146c225a2d47681a2",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "79a5eed5_43736d10",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2021-12-21T07:16:43Z",
      "side": 1,
      "message": "\u003e (Also, at \u003chttps://ci.libreoffice.org//job/lo_ubsan/2234/consoleFull#40018799748ce9c26-9d0a-43a8-83d8-c44f54920d59\u003e, this test was killed by the kill-wrapper, with the python.bin process at\n\n...and that hang still keeps happening after \u003chttps://git.libreoffice.org/core/+/40487d9c81c69c4e5ee1621e53c8162ae33c80b2%5E!/\u003e \"tdf#145062 sw: try to fix UBSan crash in UITest\", see e.g. \u003chttps://ci.libreoffice.org//job/lo_ubsan/2239/consoleFull#-135037041348ce9c26-9d0a-43a8-83d8-c44f54920d59\u003e",
      "parentUuid": "853e144e_a7b04803",
      "revId": "deea3b7471c3dab0220eca6146c225a2d47681a2",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    }
  ]
}