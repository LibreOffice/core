{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "8809e8ad_fb267015",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2021-12-16T12:08:16Z",
      "side": 1,
      "message": "This caused \u003chttps://ci.libreoffice.org//job/lo_ubsan/2233/consoleFull#-14523843999567f988-cbcf-4519-af05-6000b834f13f\u003e to fail during the new UITest_writer_tests UITEST_TEST_NAME\u003dtdf145062.Tdf145062.test_tdf145062 with\n\n  /sw/source/ui/fldui/fldref.cxx:470:32: runtime error: downcast of address 0x60700065f330 which does not point to an object of type \u0027SwGetRefField\u0027\n  0x60700065f330: note: object is of type \u0027SwInputField\u0027\n   a8 04 00 78  30 d8 f7 f1 8c 2b 00 00  60 9a d4 4c 8c 2b 00 00  00 b6 57 00 10 61 00 00  00 00 00 00\n                ^~~~~~~~~~~~~~~~~~~~~~~\n                vptr for \u0027SwInputField\u0027\n      #0 0x2b917d44b1fc in SwFieldRefPage::UpdateSubType(rtl::OUString const\u0026) /sw/source/ui/fldui/fldref.cxx:470:32\n      #1 0x2b917d463aa9 in SwFieldRefPage::TypeHdl(weld::TreeView\u0026) /sw/source/ui/fldui/fldref.cxx:358:5\n      #2 0x2b917d45f9e4 in SwFieldRefPage::Reset(SfxItemSet const*) /sw/source/ui/fldui/fldref.cxx:258:5\n      #3 0x2b917d436efd in SwFieldPage::EditNewField(bool) /sw/source/ui/fldui/fldpage.cxx:110:5\n      #4 0x2b917d48e725 in SwFieldDlg::ReInitTabPage(std::basic_string_view\u003cchar, std::char_traits\u003cchar\u003e \u003e, bool) /sw/source/ui/fldui/fldtdlg.cxx:214:16\n      #5 0x2b917d48f411 in SwFieldDlg::Activate() /sw/source/ui/fldui/fldtdlg.cxx:233:9\n      #6 0x2b8cecac5ed0 in SwChildWinWrapper::UpdateHdl(Timer*) /sw/source/uibase/fldui/fldwrap.cxx:42:26\n      #7 0x2b8cecac5afa in SwChildWinWrapper::LinkStubUpdateHdl(void*, Timer*) /sw/source/uibase/fldui/fldwrap.cxx:39:1\n      #8 0x2b8c8ac6fd61 in Link\u003cTimer*, void\u003e::Call(Timer*) const /include/tools/link.hxx:111:45\n      #9 0x2b8c8ac6f2b8 in Timer::Invoke() /vcl/source/app/timer.cxx:75:21\n      #10 0x2b8c8aab22ee in Scheduler::CallbackTaskScheduling() /vcl/source/app/scheduler.cxx:472:16\n      #11 0x2b8c8bcfdda0 in SalTimer::CallCallback() /vcl/inc/saltimer.hxx:54:13\n      #12 0x2b8c8bcf0e7c in SvpSalInstance::CheckTimeout(bool) /vcl/headless/svpinst.cxx:213:53\n      #13 0x2b8c8bcf7dbe in SvpSalInstance::ImplYield(bool, bool) /vcl/headless/svpinst.cxx:453:17\n      #14 0x2b8c8bcfa5c1 in SvpSalInstance::DoYield(bool, bool) /vcl/headless/svpinst.cxx:525:21\n      #15 0x2b8c8abafaa9 in ImplYield(bool, bool) /vcl/source/app/svapp.cxx:465:48\n      #16 0x2b8c8abaec67 in Application::Yield() /vcl/source/app/svapp.cxx:532:5\n      #17 0x2b8c87842191 in Dialog::Execute() /vcl/source/window/dialog.cxx:1056:9\n      #18 0x2b8c8a7bfabd in SalInstanceDialog::run() /vcl/source/app/salvtables.cxx:1685:23\n      #19 0x2b917cc6879c in weld::DialogController::run() /include/vcl/weld.hxx:2516:47\n      #20 0x2b917cf6e99c in SwFieldInputDlg::run() /sw/source/uibase/inc/inpdlg.hxx:56:47\n      #21 0x2b917cf4a47f in AbstractFieldInputDlg_Impl::Execute() /sw/source/ui/dialog/swdlgfact.cxx:223:20\n      #22 0x2b8cedd55e40 in SwWrtShell::StartInputFieldDlg(SwField*, bool, bool, weld::Widget*, SwWrtShell::FieldDialogPressedButton*) /sw/source/uibase/wrtsh/wrtsh2.cxx:274:36\n      #23 0x2b8cecab4428 in SwFieldMgr::InsertField(SwInsertField_Data const\u0026) /sw/source/uibase/fldui/fldmgr.cxx:1501:24\n      #24 0x2b917d4380a7 in SwFieldPage::InsertField(SwFieldTypesEnum, unsigned short, rtl::OUString const\u0026, rtl::OUString const\u0026, unsigned int, char16_t, bool) /sw/source/ui/fldui/fldpage.cxx:127:16\n      #25 0x2b917d42f02e in SwFieldFuncPage::FillItemSet(SfxItemSet*) /sw/source/ui/fldui/fldfunc.cxx:568:9\n      #26 0x2b917d48c49d in SwFieldDlg::OKHdl(weld::Button\u0026) /sw/source/ui/fldui/fldtdlg.cxx:164:16\n      #27 0x2b917d48975a in SwFieldDlg::LinkStubOKHdl(void*, weld::Button\u0026) /sw/source/ui/fldui/fldtdlg.cxx:158:1\n      #28 0x2b8c8a98c2b9 in Link\u003cweld::Button\u0026, void\u003e::Call(weld::Button\u0026) const /include/tools/link.hxx:111:45\n      #29 0x2b8c8a920dfe in weld::Button::signal_clicked() /include/vcl/weld.hxx:1410:41\n      #30 0x2b8c8a7d65f6 in SalInstanceButton::ClickHdl(Button*) /vcl/source/app/salvtables.cxx:2667:5\n      #31 0x2b8c8a7d16fa in SalInstanceButton::LinkStubClickHdl(void*, Button*) /vcl/source/app/salvtables.cxx:2655:1\n      #32 0x2b8c88362aa1 in Link\u003cButton*, void\u003e::Call(Button*) const /include/tools/link.hxx:111:45\n      #33 0x2b8c8834ae6b in Button::Click()::$_0::operator()() const /vcl/source/control/button.cxx:130:87\n      #34 0x2b8c8834a8b1 in std::_Function_handler\u003cvoid (), Button::Click()::$_0\u003e::_M_invoke(std::_Any_data const\u0026) /home/tdf/lode/opt_private/gcc-7.3.0/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../include/c++/7.3.0/bits/std_function.h:316:2\n      #35 0x2b8c88455ff1 in std::function\u003cvoid ()\u003e::operator()() const /home/tdf/lode/opt_private/gcc-7.3.0/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../include/c++/7.3.0/bits/std_function.h:706:14\n      #36 0x2b8c8844b0ef in Control::ImplCallEventListenersAndHandler(VclEventId, std::function\u003cvoid ()\u003e const\u0026) /vcl/source/control/ctrl.cxx:310:13\n      #37 0x2b8c882d1836 in Button::Click() /vcl/source/control/button.cxx:130:5\n      #38 0x2b8c8b6db89e in ButtonUIObject::execute(rtl::OUString const\u0026, std::__debug::map\u003crtl::OUString, rtl::OUString, std::less\u003crtl::OUString\u003e, std::allocator\u003cstd::pair\u003crtl::OUString const, rtl::OUString\u003e \u003e \u003e const\u0026) /vcl/source/uitest/uiobject.cxx:624:19\n      #39 0x2b8c8b75a289 in UIObjectUnoObj::executeAction(rtl::OUString const\u0026, com::sun::star::uno::Sequence\u003ccom::sun::star::beans::PropertyValue\u003e const\u0026)::$_0::operator()() const /vcl/source/uitest/uno/uiobject_uno.cxx:137:16\n      #40 0x2b8c8b7593c1 in std::_Function_handler\u003cvoid (), UIObjectUnoObj::executeAction(rtl::OUString const\u0026, com::sun::star::uno::Sequence\u003ccom::sun::star::beans::PropertyValue\u003e const\u0026)::$_0\u003e::_M_invoke(std::_Any_data const\u0026) /home/tdf/lode/opt_private/gcc-7.3.0/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../include/c++/7.3.0/bits/std_function.h:316:2\n      #41 0x2b8c88455ff1 in std::function\u003cvoid ()\u003e::operator()() const /home/tdf/lode/opt_private/gcc-7.3.0/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../include/c++/7.3.0/bits/std_function.h:706:14\n      #42 0x2b8c8b758d2d in (anonymous namespace)::ExecuteWrapper::ExecuteActionHdl(Timer*) /vcl/source/uitest/uno/uiobject_uno.cxx:102:13\n      #43 0x2b8c8b7554f4 in (anonymous namespace)::ExecuteWrapper::LinkStubExecuteActionHdl(void*, Timer*) /vcl/source/uitest/uno/uiobject_uno.cxx:97:1\n      #44 0x2b8c8ac6fd61 in Link\u003cTimer*, void\u003e::Call(Timer*) const /include/tools/link.hxx:111:45\n      #45 0x2b8c8ac6f2b8 in Timer::Invoke() /vcl/source/app/timer.cxx:75:21\n      #46 0x2b8c8aab22ee in Scheduler::CallbackTaskScheduling() /vcl/source/app/scheduler.cxx:472:16\n      #47 0x2b8c8bcfdda0 in SalTimer::CallCallback() /vcl/inc/saltimer.hxx:54:13\n      #48 0x2b8c8bcf0e7c in SvpSalInstance::CheckTimeout(bool) /vcl/headless/svpinst.cxx:213:53\n      #49 0x2b8c8bcf7dbe in SvpSalInstance::ImplYield(bool, bool) /vcl/headless/svpinst.cxx:453:17\n      #50 0x2b8c8bcfa5c1 in SvpSalInstance::DoYield(bool, bool) /vcl/headless/svpinst.cxx:525:21\n      #51 0x2b8c8abafaa9 in ImplYield(bool, bool) /vcl/source/app/svapp.cxx:465:48\n      #52 0x2b8c8abaec67 in Application::Yield() /vcl/source/app/svapp.cxx:532:5\n      #53 0x2b8c8abae8a8 in Application::Execute() /vcl/source/app/svapp.cxx:444:9\n      #54 0x2b8c4d2d7ff1 in desktop::Desktop::Main() /desktop/source/app/app.cxx:1601:13\n      #55 0x2b8c8ac58379 in ImplSVMain() /vcl/source/app/svmain.cxx:199:35\n      #56 0x2b8c8ac614d0 in SVMain() /vcl/source/app/svmain.cxx:231:12\n      #57 0x2b8c4d4d1295 in soffice_main /desktop/source/app/sofficemain.cxx:98:12\n      #58 0x4efc6c in sal_main /desktop/source/app/main.c:51:15\n      #59 0x4efc46 in main /desktop/source/app/main.c:49:1\n      #60 0x2b8c4f0e2554 in __libc_start_main /usr/src/debug/glibc-2.17-c758a686/csu/../csu/libc-start.c:266\n      #61 0x41b5c1 in _start (/instdir/program/soffice.bin+0x41b5c1)\n\nI couldn\u0027t reproduce that failure with a local ASan+UBSan build, and given that it fires from a Timer::Invoke it may be some race?  Also, no idea if this is an issue with the test code or rather uncovers a bug in the Writer code itself.",
      "revId": "deea3b7471c3dab0220eca6146c225a2d47681a2",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    }
  ]
}