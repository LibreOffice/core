{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "7f98e83b_4de322ee",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1001582
      },
      "writtenOn": "2022-07-22T11:20:11Z",
      "side": 1,
      "message": "\u003e the cppunit test CppunitTest_sc_a11y failed ( https://ci.libreoffice.org/job/gerrit_windows/131554/ )\n\nOK that\u0027s pretty weird to me, somehow in the Windows case, not only the shortcuts are part of the accessible name, but it\u0027s also in German somehow -- although test/user-template/registry-common/modifications.xcd seemingly should force the locale to en-US.\n\nI\u0027m not sure what to do hereâ€¦ for me it\u0027s inconsistent the results are that different on Windows for *the internal* a11y API.  I\u0027m also not very familiar with Windows, but it seems odd to me to present the shortcut this way to a11y -- and again, it should either be universal or done at the platform layer, not in the internal APIâ€¦ or is it something with how tests are run?  Unfortunately I don\u0027t have access to a Windows machine to play with it more though.\n\nIf it\u0027s something that seem reasonable to others though, I could adjust the code to ignore something like tab or a set of spaces followed by a shortcut (but a shortcut is not trivial to recognize, let alone in all locales) or maybe just anything after 2+ spaces or a tab or something.\nAnybody has any insight/opinion here?",
      "revId": "582075bfb075a742a900d447749bfd4129026a87",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b0aeb573_5a781eb3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000027
      },
      "writtenOn": "2022-07-26T10:32:30Z",
      "side": 1,
      "message": "the labels for the keyboard shortcuts depend on the keyboard layout and are taken from there. On top of that some are mapped by LibreOffice itself for a handful languages... https://opengrok.libreoffice.org/xref/core/vcl/win/window/keynames.cxx?r\u003d55e59695#71",
      "parentUuid": "7f98e83b_4de322ee",
      "revId": "582075bfb075a742a900d447749bfd4129026a87",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e12d72db_0bd57f18",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000789
      },
      "writtenOn": "2022-07-26T14:59:53Z",
      "side": 1,
      "message": "\u003e I\u0027m not sure what to do hereâ€¦ for me it\u0027s inconsistent the results are that different on Windows for *the internal* a11y API.  I\u0027m also not very familiar with Windows, but it seems odd to me to present the shortcut this way to a11y -- and again, it should either be universal or done at the platform layer, not in the internal APIâ€¦ or is it something with how tests are run?\n\nIn this particular case, it actually looks platform-specific; OAccessibleMenuItemComponent::GetAccessibleName in accessibility/source/standard/accessiblemenuitemcomponent.cxx has this:\n\n    #if defined(_WIN32)\n            if ( m_pParent-\u003eGetAccelKey( nItemId ).GetName().getLength() )\n                sName +\u003d \"\\t\" + m_pParent-\u003eGetAccelKey(nItemId).GetName();\n    #endif\n\nwhich was added in \n\n\n    commit d22a27010c4bd55973165a5fc373027f7c251db8\n    Author: Niklas Johansson \u003csleeping.pillow@gmail.com\u003e\n    Date:   Wed Dec 17 23:05:15 2014 +0100\n\n        Accessibility: Expose keyboard short-cuts of menu entries\n        \n        On Windows the keyboard short-cuts of menu items like\n        \"Open Ctrl+O\" is not exposed to accessibility tools on\n        Windows. On Mac and Linux it is.\n        \n        If I understand Microsoft\u0027s notes correctly, it is expected\n        that the short-cut gets appended to the accessibleName.\n        This is what Acrobat Reader, Internet Explorer, Firefox\n        is doing. And with this patch LibreOffice as well.\n        \n        For info from Microsoft on the matter see:\n        http://msdn.microsoft.com/en-us/library/windows/desktop/dd318482%28v\u003dvs.85%29.aspx\n        \n        Change-Id: I4ed7c4c45998063bb50744b44c792351070489d7\n        Reviewed-on: https://gerrit.libreoffice.org/13516\n        Reviewed-by: CaolÃ¡n McNamara \u003ccaolanm@redhat.com\u003e\n        Tested-by: CaolÃ¡n McNamara \u003ccaolanm@redhat.com\u003e\n\nI don\u0027t know whether or not that\u0027s actually how it\u0027s supposed to work for a11y (in general and on Windows in particular), but your suggestion to take care of that in the platform-specific code (if at all) generally sounds reasonable to me. (Maybe appending what get_accKeyboardShortcut() returns to the string currently returned in getAccName() in winaccessibility\\source\\UAccCOM\\MAccessible.cxx - based on the role? - would do that, but would probably need a closer look whether it does and whether it\u0027s desirable in the first place).",
      "parentUuid": "b0aeb573_5a781eb3",
      "revId": "582075bfb075a742a900d447749bfd4129026a87",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3dab8e25_5a5a7b26",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1001582
      },
      "writtenOn": "2022-07-26T15:31:24Z",
      "side": 1,
      "message": "I actually just uploaded an updated version with something like that in here, finally finding the culprit you just handed me now -- funny timing ðŸ˜Š\n\nThe commit message seems odd to me, because AFAIK it\u0027s not true on Linux (at least, none of GTK, Firefox and LO include the shortcut in the name here), and the shortcuts are only available through the AccessibleAction they are tied with.\n\nNevertheless, as it\u0027s currently how the code is wired, it makes sense to test for it, whether it\u0027s ultimately expected behavior or not -- we\u0027ll just have to update everything accordingly if something changes.  I didn\u0027t go to the trouble of actually checking the shortcut value because I couldn\u0027t find a good way to get that very value from the accessible object, and it seems safe enough to me to accept a \"\\t\u003cANYTHING\u003e\" suffix for menu item names.  If it\u0027s not, I\u0027ll have to figure something out.",
      "parentUuid": "e12d72db_0bd57f18",
      "revId": "582075bfb075a742a900d447749bfd4129026a87",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9698d2c4_896fb7e8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000789
      },
      "writtenOn": "2022-07-27T15:03:10Z",
      "side": 1,
      "message": "Looks good to me and seems reasonable to decouple any potential changes there from this change.",
      "parentUuid": "3dab8e25_5a5a7b26",
      "revId": "582075bfb075a742a900d447749bfd4129026a87",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    }
  ]
}