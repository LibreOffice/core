{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "6edb8efb_ea41efc3",
        "filename": "scaddins/source/datefunc/datefunc.cxx",
        "patchSetId": 4
      },
      "lineNbr": 341,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2021-09-22T19:57:21Z",
      "side": 0,
      "message": "I believe that this code matches e.g. Date::DateToDays, and is correct. Also I believe that the problem lies somewhere in the code that converts user string like \"0001-01-01\" into a serial date.",
      "revId": "5fc94be9d55791340a56f238ded12261f68af552",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9bd53d03_53c16596",
        "filename": "scaddins/source/datefunc/datefunc.cxx",
        "patchSetId": 4
      },
      "lineNbr": 341,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2021-09-22T21:01:40Z",
      "side": 0,
      "message": "Converting the number -693595 (which is intended to be 0001-01-01) to string representation in SvNumberformat::ImpGetDateOutput calls GregorianCalendar::handleComputeFields (in UnpackedTarball/icu/source/i18n/gregocal.cpp). And there I can see that the value of \u0027julianDay\u0027 - which is the representation of the date passed from Calc (-693595) in the GregorianCalendar, counting from somewhere ~-4713-01-01, is 1721424, while \u0027kJan1_1JulianDay\u0027 (defined in UnpackedTarball/icu/source/i18n/gregoimp.h as \"January 1, year 1 (Gregorian)\") is 1721426. We obviously have something very wrong here.",
      "parentUuid": "6edb8efb_ea41efc3",
      "revId": "5fc94be9d55791340a56f238ded12261f68af552",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "28843302_4a662d2b",
        "filename": "scaddins/source/datefunc/datefunc.cxx",
        "patchSetId": 4
      },
      "lineNbr": 341,
      "author": {
        "id": 1002115
      },
      "writtenOn": "2021-09-22T21:04:34Z",
      "side": 0,
      "message": "I even tried a calculation using 02.01.0001:\nsal_uInt16 nDay \u003d 2;\nsal_uInt16 nMonth \u003d 1;\nsal_uInt16 nYear \u003d 1;\nsal_Int32 nDays \u003d DateToDays(nDay, nMonth, nYear);\n\nI would expect that one day passed, but nDays is 2, since the days are just added. For 01.01.0001 nDays is 1. Hence one day passed? *confused I don\u0027t know, but I would rather expect it to be 0.",
      "parentUuid": "6edb8efb_ea41efc3",
      "revId": "5fc94be9d55791340a56f238ded12261f68af552",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0d566da6_ad898c2d",
        "filename": "scaddins/source/datefunc/datefunc.cxx",
        "patchSetId": 4
      },
      "lineNbr": 341,
      "author": {
        "id": 1000023
      },
      "writtenOn": "2021-09-23T13:07:19Z",
      "side": 0,
      "message": "This is not an offset but calculates a *count* of days starting 0001-01-01 as day 1 (including that day). So if you want, an offset from day 0 the day before (-0001-12-31).\nSee also\nhttps://opengrok.libreoffice.org/xref/core/tools/source/datetime/tdate.cxx?r\u003dea61644a#50 and\nhttps://opengrok.libreoffice.org/xref/core/tools/source/datetime/tdate.cxx?r\u003dea61644a#147\n\nNote also that this calculates the day count in the proleptic Gregorian calendar, which for the years 4 to 100 is behind the Julian calendar by 2 days, which probably explains the -2 days difference Mike observed in ICU. (Also, leap years in Julian calendar weren\u0027t introduced before year 4). See\nhttps://en.wikipedia.org/wiki/Proleptic_Gregorian_calendar#Difference_between_Julian_and_proleptic_Gregorian_calendar_dates\n\nICU Julian day numbers probably will be identical for day numbers passed from Calc for dates from 1 March 200 to 28 February 300.\n\nHowever, the offset from null-date (1899-12-30) calculated in Calc is based on the then current calendar, here Julian for 0001-01-01, for which the day count to a specific date in the proleptic Gregorian calendar is not identical (or only in the years 200 to 300).",
      "parentUuid": "28843302_4a662d2b",
      "revId": "5fc94be9d55791340a56f238ded12261f68af552",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    }
  ]
}