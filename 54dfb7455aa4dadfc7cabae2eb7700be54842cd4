{
  "comments": [
    {
      "key": {
        "uuid": "ad87291e_e6f93fea",
        "filename": "basic/qa/vba_tests/strconv.vb",
        "patchSetId": 1
      },
      "lineNbr": 24,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2021-03-16T08:47:00Z",
      "side": 1,
      "message": "Also a whitespace change. Please remove the added whitespace, keep just an empty line.",
      "revId": "54dfb7455aa4dadfc7cabae2eb7700be54842cd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "da28ba51_0adb6ede",
        "filename": "basic/qa/vba_tests/strconv.vb",
        "patchSetId": 1
      },
      "lineNbr": 29,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2021-03-16T08:47:00Z",
      "side": 1,
      "message": "Isn\u0027t it expected to do the opposite to the test above? Should we use the same strings maybe?",
      "revId": "54dfb7455aa4dadfc7cabae2eb7700be54842cd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dbe75de2_aa5acf26",
        "filename": "basic/qa/vba_tests/strconv.vb",
        "patchSetId": 1
      },
      "lineNbr": 40,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2021-03-16T08:47:00Z",
      "side": 1,
      "message": "You could bytes in UTF-8 string. Linuxes may have different encoding; and also I suppose that Windows could have that, too. There are some multibyte codepages out there on Windows, so ... We need to find out how to check the active system encoding.",
      "revId": "54dfb7455aa4dadfc7cabae2eb7700be54842cd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "13bdaabc_72eeb7e4",
        "filename": "basic/qa/vba_tests/strconv.vb",
        "patchSetId": 1
      },
      "lineNbr": 40,
      "author": {
        "id": 1002925
      },
      "writtenOn": "2021-03-17T21:24:33Z",
      "side": 1,
      "message": "So the thing is output does not only depend on encoding but also the string.\nConsider the encoding \"UTF-8\" where ASCII characters like A,B,C take 1 byte and special characters take 2-4 bytes which is not fixed and it depends on which special character we are talking about as in our example string \"ÉÏº£ÊÐABC\" ,characters other than ABC take 2 bytes/character(that is why we are getting total length \u003d 6*2+3 \u003d 15).Now this value \"2\" is not fixed and can vary also if we change the special character.\n\nFollowing info has been taken from internet and gives us idea how bytes/character varies for different characters in \"UTF-8\".\n\n- The first 128 Unicode code points, U+0000 to U+007F, used for the C0 Controls and Basic Latin characters and which correspond one-to-one to their ASCII-code equivalents, are encoded using \"1 bytes\" in UTF-8.\n\n- The next 1,920 characters, U+0080 to U+07FF (encompassing the remainder of almost all Latin-script alphabets, and also Greek, Cyrillic, Coptic, Armenian, Hebrew, Arabic, Syriac, Tāna and N\u0027Ko), require \"2 bytes\" to encode in UTF-8.\n\n- For U+0800 to U+FFFF, i.e. the remainder of the characters in the Basic Multilingual Plane (BMP, plane 0, U+0000 to U+FFFF), which encompasses the rest of the characters of most of the world\u0027s living languages, UTF-8 needs 3 bytes to encode a character.\n\n- Code points U+010000 to U+10FFFF, which represent characters in the supplementary planes (planes 1-16), require 4 bytes in UTF-8.\n\n\nSo i don\u0027t think there is any point of making various cases of encoding for string like \"ÉÏº£ÊÐABC\".\nI mean tomorrow one can change any character of this string and use a special character which occupies 3 bytes(then length of output will again change) \nAnd our motive is not to make cases for various encoding but to check if it is returning correct output(and correct length of string) which vbFromUnicode is actually doing.\n\nI suggest to use simple ASCII characters in the testing string because in almost every encoding ASCII characters occupy 1 byte per character.\n\nWhats your comment on this ?\nThanks.",
      "parentUuid": "dbe75de2_aa5acf26",
      "revId": "54dfb7455aa4dadfc7cabae2eb7700be54842cd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0f3896ac_24e2c729",
        "filename": "basic/qa/vba_tests/strconv.vb",
        "patchSetId": 1
      },
      "lineNbr": 40,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2021-03-18T08:13:46Z",
      "side": 1,
      "message": "Not only that, but also differences between *actual* encodings used out there. E.g., my Russian Windows OS uses CP-1251, and it would be a single-byte encoding incapable of representing that input, so the test would fail. People on Japanese Windows would see something else.\n\nBut the explicitly defined encoding is indeed useful, and we expect that whenever  an explicit encoding is passed, we know either source or destination encoding. So we may have a fixed character strings, and test those with explicit encoding parameters, making sure those are returning expected output.",
      "parentUuid": "13bdaabc_72eeb7e4",
      "revId": "54dfb7455aa4dadfc7cabae2eb7700be54842cd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9b0869e6_18abf41b",
        "filename": "basic/qa/vba_tests/strconv.vb",
        "patchSetId": 1
      },
      "lineNbr": 40,
      "author": {
        "id": 1002925
      },
      "writtenOn": "2021-03-18T19:11:36Z",
      "side": 1,
      "message": "You talked about encodings of system(CP-1251 and some other encoding on japanese windows) but the output will not depend on your system encoding rather it will depend on encoding of the application(LO).\n\nAfter reading about encoding standards and its compatibility with LO i found that .ods files are always rendered in \"utf-8\" in ubuntu and \"ascii\" encoding in Windows.\nSo it does not matter whatever system encoding we have ultimately results depend on encoding of the application(which is fixed for Windows and Ubuntu).\n\nCorrect me if i am wrong at any point.\nThanks.",
      "parentUuid": "0f3896ac_24e2c729",
      "revId": "54dfb7455aa4dadfc7cabae2eb7700be54842cd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dfeb9218_cabfc8f9",
        "filename": "basic/qa/vba_tests/strconv.vb",
        "patchSetId": 1
      },
      "lineNbr": 40,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2021-03-22T06:56:36Z",
      "side": 1,
      "message": "\u003e You talked about encodings of system(CP-1251 and some other encoding on japanese windows) but the output will not depend on your system encoding rather it will depend on encoding of the application(LO).\n\nStrConv converts between Unicode and \"local encoding\" (byte string). While it\u0027s correct that LibreOffice has its own locale potentially independent from system\u0027s, LibreOffice uses system locale *by default*, and that means that you need to take that into account. Note that that is *not* \"encoding of application\" - whatever that might mean.\n\nIt\u0027s *your* task to make sure StrConv uses the correct encoding for its work. When doing its \u0027vbUnicode\u0027/\u0027vbFromUnicode\u0027, it needs to get the proper source/target encoding; it\u0027s trivial when it is passed explicitly through its third LCID argument, but when it\u0027s missing, it must be taken from LO locale, and thus potentially from system. It must not use osl_getThreadTextEncoding, as it does now.\n\n\u003e .ods files are always rendered in \"utf-8\" in ubuntu and \"ascii\" encoding in Windows.\n\nThis is very strange and incorrect statement (I wonder what might be the source of the misconception). Inside ODF files, all XMLs are UTF-8-encoded, regardless of the system. And that has nothing to do with our problem here. And again - what is \"encoding of the application\"? There\u0027s nothing like that. LibreOffice (or any other application) may use any encoding at any place; we have a weird mix of osl_getThreadTextEncoding vs app-configured locales...",
      "parentUuid": "9b0869e6_18abf41b",
      "revId": "54dfb7455aa4dadfc7cabae2eb7700be54842cd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7e9e1484_914809f0",
        "filename": "basic/source/runtime/methods.cxx",
        "patchSetId": 1
      },
      "lineNbr": 4144,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2021-03-16T08:47:00Z",
      "side": 1,
      "message": "I\u0027m starting to think that we might even not want to consider the system locale/language here. Why? We use Unicode everywhere, so \"codepages\" do not affect us. Would allowing the flags irrespective of the locale break something?",
      "revId": "54dfb7455aa4dadfc7cabae2eb7700be54842cd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "89f301de_b7f622a5",
        "filename": "basic/source/runtime/methods.cxx",
        "patchSetId": 1
      },
      "lineNbr": 4144,
      "author": {
        "id": 1002925
      },
      "writtenOn": "2021-03-16T18:57:30Z",
      "side": 1,
      "message": "\u003e I\u0027m starting to think that we might even not want to consider the system locale/language here. Why? We use Unicode everywhere, so \"codepages\" do not affect us. Would allowing the flags irrespective of the locale break something?\n\nNo it will not break and execute all tests successfully.\nThe point is then whats the use of optional parameter  - lcid.\nWe use unicode in our code everywhere it makes StrConv independent of codepages.\n\nSo is it really necessary to have optional parameter lcid ?\nI think \"No\" due to use of unicode in our code.\nIn the VBA documentation https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/strconv-function you can see use of lcid.\nFrom this documentation I think maybe they have not used unicode and used codepages which will be default if optional parameter(lcid) is not provided.If it is provided codepage will be that of provided locale.\n\nBut in LO things have been coded differently.\nWhat do you think about this ?",
      "parentUuid": "7e9e1484_914809f0",
      "revId": "54dfb7455aa4dadfc7cabae2eb7700be54842cd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "35539903_d287da3b",
        "filename": "basic/source/runtime/methods.cxx",
        "patchSetId": 1
      },
      "lineNbr": 4144,
      "author": {
        "id": 1002925
      },
      "writtenOn": "2021-03-16T18:59:02Z",
      "side": 1,
      "message": "\u003e \u003e I\u0027m starting to think that we might even not want to consider the system locale/language here. Why? We use Unicode everywhere, so \"codepages\" do not affect us. Would allowing the flags irrespective of the locale break something?\n\u003e \n\u003e No it will not break and execute all tests successfully.\n\u003e The point is then whats the use of optional parameter  - lcid.\n\u003e We use unicode in our code everywhere it makes StrConv independent of codepages.\n\u003e \n\u003e So is it really necessary to have optional parameter lcid ?\n\u003e I think \"No\" due to use of unicode in our code.\n\u003e In the VBA documentation https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/strconv-function you can see use of lcid.\n\u003e From this documentation I think maybe they have not used unicode and used codepages which will be default if optional parameter(lcid) is not provided.If it is provided codepage will be that of provided locale.\n\u003e \n\u003e But in LO things have been coded differently.\n\u003e What do you think about this ?\n\nIt also means we don\u0027t need third argument in StrConv function.\nThanks.",
      "parentUuid": "89f301de_b7f622a5",
      "revId": "54dfb7455aa4dadfc7cabae2eb7700be54842cd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615",
      "unresolved": true
    }
  ]
}