{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "464603df_e0d70361",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1002862
      },
      "writtenOn": "2022-01-06T22:03:17Z",
      "side": 1,
      "message": "Mike, this patch is breaking an existing QA test: basic/qa/vba_tests/ismissing.vb\n\nI am now trying to figure out what is causing it. It seems the test uses IsNull in the way it previously worked.",
      "revId": "2c3c10c68024eb8b3cfdcf167a65925f811d5fd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cbfac0a8_46ea7aad",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2022-01-07T04:44:59Z",
      "side": 1,
      "message": "Andreas: please could you take a look at the failing tests - are they misusing previous buggy behavior?",
      "parentUuid": "464603df_e0d70361",
      "revId": "2c3c10c68024eb8b3cfdcf167a65925f811d5fd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1c22f6d8_e1e1365f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1002115
      },
      "writtenOn": "2022-01-07T09:12:50Z",
      "side": 1,
      "message": "I will finish another task, then I will check. Nice work!",
      "revId": "2c3c10c68024eb8b3cfdcf167a65925f811d5fd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ff0f6428_03186243",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1002115
      },
      "writtenOn": "2022-01-07T14:49:28Z",
      "side": 1,
      "message": "So imho, we should adapt the test cases in the ismissing file to reflect the change adding a comment.",
      "revId": "2c3c10c68024eb8b3cfdcf167a65925f811d5fd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5f01a12b_26369b61",
        "filename": "basic/qa/vba_tests/ismissing.vb",
        "patchSetId": 3
      },
      "lineNbr": 26,
      "author": {
        "id": 1002115
      },
      "writtenOn": "2022-01-07T09:40:11Z",
      "side": 1,
      "message": "\u0027 will be initialized to their respective default value of its datatype.\ntherefore we have an object with the value NULL (set in\nhttps://opengrok.libreoffice.org/xref/core/basic/source/runtime/runtime.cxx?r\u003d26f46b86#4264), and since this change targets the IsNull function it fails.\n\nWe could add the pInfo of a missing parameter, if the parameter is of type object and replace the method calls with IsMissing instead of IsNull like in https://opengrok.libreoffice.org/xref/core/basic/qa/basic_coverage/test_ismissing_basic.bas?r\u003d0ad1810a#142",
      "revId": "2c3c10c68024eb8b3cfdcf167a65925f811d5fd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "321633ca_54443418",
        "filename": "basic/qa/vba_tests/ismissing.vb",
        "patchSetId": 3
      },
      "lineNbr": 26,
      "author": {
        "id": 1002115
      },
      "writtenOn": "2022-01-07T09:51:14Z",
      "side": 1,
      "message": "After some tests, it does not work to set just the ismissing, since the method checks for an error state (448) which will be set in StepParam before the optional check",
      "parentUuid": "5f01a12b_26369b61",
      "revId": "2c3c10c68024eb8b3cfdcf167a65925f811d5fd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d0f6eded_1d96f95d",
        "filename": "basic/qa/vba_tests/ismissing.vb",
        "patchSetId": 3
      },
      "lineNbr": 26,
      "author": {
        "id": 1002862
      },
      "writtenOn": "2022-01-07T14:41:21Z",
      "side": 1,
      "message": "According to MS documentation at:\nhttps://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/ismissing-function\n\nIt seems that IsMissing works only with Variant types.\n\nFor example, run this code in MS Office and see that IsMissing works only in TestVariant, not in TestCollection.\n\nFunction TestCollection(Optional A As Collection)\n    MsgBox IsNull(A)\n    MsgBox IsMissing(A)\nEnd Function\n\nFunction TestVariant(Optional A As Variant)\n    MsgBox IsNull(A)\n    MsgBox IsMissing(A)\nEnd Function\n\nSub CallTest()\n    Dim cA As Collection\n    TestCollection\n    TestCollection cA\n    TestVariant\n    TestVariant cA\nEnd Sub\n\nNote also that it does not work with String types.\n\nFunction TestString(Optional S As String)\n    MsgBox IsNull(S)\n    MsgBox IsMissing(S)\nEnd Function\n\nSub CallTest2()\n    TestString\n    TestString (\"123\")\nEnd Sub",
      "parentUuid": "321633ca_54443418",
      "revId": "2c3c10c68024eb8b3cfdcf167a65925f811d5fd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c85bcdd_c4e4cc78",
        "filename": "basic/qa/vba_tests/ismissing.vb",
        "patchSetId": 3
      },
      "lineNbr": 155,
      "author": {
        "id": 1000994
      },
      "writtenOn": "2022-01-07T04:44:59Z",
      "side": 1,
      "message": "The problem looks to be here and in the next method.",
      "revId": "2c3c10c68024eb8b3cfdcf167a65925f811d5fd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "603bc1a1_4ec37084",
        "filename": "basic/qa/vba_tests/ismissing.vb",
        "patchSetId": 3
      },
      "lineNbr": 156,
      "author": {
        "id": 1002862
      },
      "writtenOn": "2022-01-07T13:10:51Z",
      "side": 1,
      "message": "Mike and Andreas, it seems that this unit test was built using the wrong idea of what IsNull actually does in MS VBA. For example, running the following code in MS Office:\n\nFunction TestA(Optional A As Collection, Optional B As Collection)\n    MsgBox IsNull(A) \u0027 Prints False\n    MsgBox IsNull(B) \u0027 Prints False\nEnd Function\n\nSub CallTestA()\n    Dim cA As New Collection\n    cA.Add (123)\n    cA.Add (456)\n    Dim cB As New Collection\n    cB.Add (123.4)\n    cB.Add (456.7)\n    \u0027 Calling TestA without arguments\n    TestA\nEnd Sub\n\n... will print False for both parameters. Hence, calling the Function without arguments and test for the existence of these arguments inside the function using IsNull returns False in MS Office.\n\nHowever, this test assumes that IsNull will return True if an argument is missing, which is not what VBA does.\n\nThe weird thing is that replacing IsNull for IsMissing in MS VBA still returns False.",
      "range": {
        "startLine": 156,
        "startChar": 34,
        "endLine": 156,
        "endChar": 54
      },
      "revId": "2c3c10c68024eb8b3cfdcf167a65925f811d5fd4",
      "serverId": "6622c302-437a-49ad-a91d-55ba7dcf1615"
    }
  ]
}