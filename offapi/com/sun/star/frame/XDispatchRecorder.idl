/* -*- Mode: C++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */
/*************************************************************************
 *
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * Copyright 2000, 2010 Oracle and/or its affiliates.
 *
 * OpenOffice.org - a multi-platform office productivity suite
 *
 * This file is part of OpenOffice.org.
 *
 * OpenOffice.org is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License version 3
 * only, as published by the Free Software Foundation.
 *
 * OpenOffice.org is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License version 3 for more details
 * (a copy is included in the LICENSE file that accompanied this code).
 *
 * You should have received a copy of the GNU Lesser General Public License
 * version 3 along with OpenOffice.org.  If not, see
 * <http://www.openoffice.org/license.html>
 * for a copy of the LGPLv3 License.
 *
 ************************************************************************/
#ifndef __com_sun_star_frame_XDispatchRecorder_idl__
#define __com_sun_star_frame_XDispatchRecorder_idl__

#include <com/sun/star/uno/XInterface.idl>
#include <com/sun/star/util/URL.idl>
#include <com/sun/star/beans/PropertyValue.idl>


module com {  module sun {  module star {  module frame {

 published interface XFrame;

/** provides recording functionality of dispatches

    <p>
    With such recorder it will be possible to record requests of type
    <type>XDispatch</type> by using additional interface
    <type>XRecordableDispatch</type>. The result of that will be a
    a script which can be used to start the dispatch at later time again.
    Such recorder objects are available on a <type>XDispatchRecorderSupplier</type>
    which is provided by the <type>Frame</type> service.
    </p>

    @see Frame
    @see XDispatchRecorderSupplier

    @since OOo 1.1.2
 */
published interface XDispatchRecorder: com::sun::star::uno::XInterface
{
    /** initializes the recorder by passing the frame for which all
        macro statements shall be recorded

        @param Frame
            it includes the document on which such requests shall be recorded
    */
    void startRecording( [in] com::sun::star::frame::XFrame Frame );

    /** stops the recording process

        <p>
        Must be called in pairs with <member>XDispatchRecorder::startRecording()</member>.
        </p>

        @attention  The recorder uses this method to control the lifetime of its internal
                    used macro buffer. It will be cleared here. So the macro must be fetched
                    before endRecording() is called.

        @see        getRecordedMacro()
    */
    void endRecording();

    /** records a single dispatch call identified by its command URL

        @param URL
            the full parsed command URL

        @param Arguments
            optional arguments for the command URL
            <br>
            (see <type scope="com::sun::star::document">MediaDescriptor</type>
             for further informations)
    */
    void recordDispatch(
        [in] com::sun::star::util::URL URL,
        [in] sequence<com::sun::star::beans::PropertyValue> Arguments);

    /** records a single dispatch call identified by its command URL, but
        comments it out

        <p>
        This way calls that failed on execution can be documented.
        </p>

        @param URL
            the full parsed command URL

        @param Arguments
            optional arguments for the command URL
            <br>
            (see <type scope="com::sun::star::document">MediaDescriptor</type>
             for further informations)
    */
    void recordDispatchAsComment(
        [in] com::sun::star::util::URL URL,
        [in] sequence<com::sun::star::beans::PropertyValue> Arguments);

    /** returns the recorded source code

        <p>
        This method must be used before <member>endRecording()</member> is called!
        Otherwise the macro will be released.
        </p>

        @returns
            the recorded data as a string which can be interpreted as a script
    */
    string getRecordedMacro();
};


}; }; }; };

#endif

/* vim:set shiftwidth=4 softtabstop=4 expandtab: */
