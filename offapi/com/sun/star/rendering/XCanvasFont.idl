/*************************************************************************
 *
 *  OpenOffice.org - a multi-platform office productivity suite
 *
 *  $RCSfile: XCanvasFont.idl,v $
 *
 *  $Revision: 1.4 $
 *
 *  last change: $Author: rt $ $Date: 2005-09-08 02:58:19 $
 *
 *  The Contents of this file are made available subject to
 *  the terms of GNU Lesser General Public License Version 2.1.
 *
 *
 *    GNU Lesser General Public License Version 2.1
 *    =============================================
 *    Copyright 2005 by Sun Microsystems, Inc.
 *    901 San Antonio Road, Palo Alto, CA 94303, USA
 *
 *    This library is free software; you can redistribute it and/or
 *    modify it under the terms of the GNU Lesser General Public
 *    License version 2.1, as published by the Free Software Foundation.
 *
 *    This library is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 *    Lesser General Public License for more details.
 *
 *    You should have received a copy of the GNU Lesser General Public
 *    License along with this library; if not, write to the Free Software
 *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
 *    MA  02111-1307  USA
 *
 ************************************************************************/
#ifndef __com_sun_star_rendering_XCanvasFont_idl__
#define __com_sun_star_rendering_XCanvasFont_idl__

#ifndef __com_sun_star_uno_XInterface_idl__
#include <com/sun/star/uno/XInterface.idl>
#endif
#ifndef __com_sun_star_lang_IllegalArgumentException_idl__
#include <com/sun/star/lang/IllegalArgumentException.idl>
#endif
#ifndef __com_sun_star_geometry_RealRectangle2D_idl__
#include <com/sun/star/geometry/RealRectangle2D.idl>
#endif
#ifndef __com_sun_star_rendering_FontRequest_idl__
#include <com/sun/star/rendering/FontRequest.idl>
#endif
#ifndef __com_sun_star_rendering_FontMetrics_idl__
#include <com/sun/star/rendering/FontMetrics.idl>
#endif
#ifndef __com_sun_star_rendering_RenderState_idl__
#include <com/sun/star/rendering/RenderState.idl>
#endif
#ifndef __com_sun_star_rendering_ViewState_idl__
#include <com/sun/star/rendering/ViewState.idl>
#endif
#ifndef __com_sun_star_rendering_StringContext_idl__
#include <com/sun/star/rendering/StringContext.idl>
#endif

#ifndef __com_sun_star_beans_PropertyValue_idl__
#include <com/sun/star/beans/PropertyValue.idl>
#endif


module com { module sun { module star { module rendering {

interface XCanvas;
interface XTextLayout;
interface XPolyPolygon2D;

/** This interface provides access to a specific, XCanvas-dependent
    font incarnation. This font is not universally usable, but belongs
    to the XCanvas it was queried from.
 */
interface XCanvasFont : ::com::sun::star::uno::XInterface
{
    /** Create a text layout interface.<p>

        Create a text layout interface for the given string, using
        this font to generate the glyphs from.<p>

        @param aText
        The text to layout.

        @param nDirection
        Main text direction for the string specified. The main text
        direction is e.g. important for characters that are not
        strong, i.e. that change affinity according to the current
        writing direction. Make sure that across text portions and
        lines, the direction is set consistently.

        @param nRandomSeed
        Optional random seed for OpenType glyph variations.
     */
    XTextLayout                                         createTextLayout( [in] StringContext aText, [in] byte nDirection, [in] hyper nRandomSeed );

    //-------------------------------------------------------------------------

    /** Query the FontRequest that was used to generate this object.
     */
    FontRequest                                         getFontRequest();

    //-------------------------------------------------------------------------

    /** Query metric information about the font, that is generic to
        all its glyphs.<p>

        Note that the metric values in the returned result are in the
        font coordinate system, i.e. relative to the corresponding
        size of this font. That is, when this font was created with a
        cell size of 20 units, the metrics returned are calculated
        relative to this size.
     */
    FontMetrics                                         getFontMetrics();

    //-------------------------------------------------------------------------

    /** Query the list of available font sizes.<p>

        This method queries the list of available font sizes (in
        device units) for this font. For scalable fonts that are not
        restricted to discrete sizes, this list is <em>empty</em>,
        meaning that every size is possible. Fonts that <em>do</em>
        restrict the device size to certain discrete values, setting
        an overall transformation that scales the
        <member>FontRequest::CellSize</member> to something not
        contained in the list returned by this method can lead to
        visible disturbances.<p>
     */
    sequence< double >                                  getAvailableSizes();

    //-------------------------------------------------------------------------

    /** Query the list of additional font properties.<p>
     */
    sequence< ::com::sun::star::beans::PropertyValue >  getExtraFontProperties();

    //-------------------------------------------------------------------------

};

}; }; }; };

#endif

